<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="google-site-verification" content="d13Hh8m2coFjR-lHc63J8TJZSHc95Q5bJAxervsJEtk" />
    <link rel="shortcut icon" href="favicon.jpg" type="image/x-icon">
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">




        <!-- Primary Meta Tags -->
    <title>LND Multi-Tool Suite | Free AI-Powered Creative & Utility Tools</title>
    <meta name="description" content="Your all-in-one suite of free AI-powered tools. Generate AI art, convert text to speech, and use 30+ utility tools‚Äîno sign-up required.">
    <meta name="keywords" content="AI tools, free AI generator, LND, LND AI, Ai, LND AI HUB, lndaihub, lnd ai hub, multi-tool suite, text to image AI, text to speech online, online utility tools, AI art generator, free text to image uncensored, web image scraper, QR code scanner online, tone generator, GPS location finder, notes saver, online to-do list, dice roller, coin toss, how to generate AI images for free, best free text to speech with download, online tools that save data, browser based utility tools, all in one creative suite, free developer tools online, IP address finder, currency converter tool, AI tools India, online utilities Rajasthan, creative AI tools for professionals India">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://lndaihub.netlify.app/" />

    <!-- Responsive -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Open Graph / Facebook (no image) -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://lndaihub.netlify.app/">
    <meta property="og:title" content="LND Multi-Tool Suite | Free AI-Powered Tools">
    <meta property="og:description" content="30+ free tools: AI art, TTS, QR scanners, notes, developer utilities. No login.">

    <!-- Twitter (no image) -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:url" content="https://lndaihub.netlify.app/">
    <meta name="twitter:title" content="LND Multi-Tool Suite | Free AI Tools">
    <meta name="twitter:description" content="All-in-one AI tool suite: generate art, speech, and use 30+ creative utilities‚Äîcompletely free.">


    <script type="application/ld+json">
        {
          "@context": "https://schema.org",
          "@type": "WebApplication",
          "name": "LND Multi-Tool Suite",
          "url": "https://lndaihub.netlify.app/",
          "description": "All-in-one suite of free AI-powered creative and utility tools. Text-to-image, TTS, QR code scanner, and 30+ browser tools.",
          "applicationCategory": "UtilitiesApplication",
          "operatingSystem": "All",
          "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
          },
          "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.9",
            "reviewCount": "12000"
          }
        }
        </script>
        




    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Space+Grotesk:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Professional Dark Purple & Black Palette */
            --primary-purple: #2D1B69;
            --secondary-purple: #4C1D95;
            --dark-purple: #1E1B4B;
            --light-purple: #6366F1;
            --accent-purple: #8B5CF6;
            --bg-black: #000000;
            --bg-dark: #0F0F23;
            --bg-darker: #0A0A1A;
            --text-light: #F8FAFC;
            --text-accent: #E2E8F0;
            --text-muted: #94A3B8;
            --glass-bg: rgba(45, 27, 105, 0.15);
            --glass-border: rgba(139, 92, 246, 0.3);
            --shadow-primary: rgba(45, 27, 105, 0.4);
            --shadow-accent: rgba(139, 92, 246, 0.2);
        }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background: linear-gradient(135deg, var(--bg-black) 0%, var(--bg-darker) 20%, var(--dark-purple) 40%, var(--primary-purple) 60%, var(--secondary-purple) 80%, var(--dark-purple) 100%);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
            min-height: 100vh;
            color: var(--text-light);
            overflow-x: hidden;
            position: relative;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            25% { background-position: 100% 50%; }
            50% { background-position: 100% 100%; }
            75% { background-position: 0% 100%; }
            100% { background-position: 0% 50%; }
        }

        /* Enhanced Particle System */
        .cosmic-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: var(--accent-purple);
            border-radius: 50%;
            animation: float 8s ease-in-out infinite;
            box-shadow: 0 0 6px var(--accent-purple);
        }

        @keyframes float {
            0%, 100% { 
                transform: translateY(0px) rotate(0deg) scale(0.8); 
                opacity: 0.4; 
            }
            25% { 
                transform: translateY(-15px) rotate(90deg) scale(1.2); 
                opacity: 0.8; 
            }
            50% { 
                transform: translateY(-30px) rotate(180deg) scale(1); 
                opacity: 1; 
            }
            75% { 
                transform: translateY(-15px) rotate(270deg) scale(1.1); 
                opacity: 0.6; 
            }
        }

        /* Animated Background Overlay */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 80%, rgba(139, 92, 246, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(45, 27, 105, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 40% 40%, rgba(76, 29, 149, 0.05) 0%, transparent 50%);
            animation: backgroundPulse 15s ease-in-out infinite;
            z-index: 0;
        }

        @keyframes backgroundPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }

        .container {
            position: relative;
            z-index: 2;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            text-align: center;
            padding: 50px 30px;
            margin-bottom: 40px;
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 2px solid var(--glass-border);
            border-radius: 25px;
            box-shadow: 
                0 25px 50px var(--shadow-primary),
                inset 0 1px 0 rgba(255, 255, 255, 0.1),
                0 0 0 1px rgba(139, 92, 246, 0.1);
            position: relative;
            overflow: hidden;
            animation: headerGlow 3s ease-in-out infinite alternate;
        }

        @keyframes headerGlow {
            0% { box-shadow: 0 25px 50px var(--shadow-primary), inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 0 0 1px rgba(139, 92, 246, 0.1); }
            100% { box-shadow: 0 30px 60px var(--shadow-primary), inset 0 1px 0 rgba(255, 255, 255, 0.15), 0 0 0 2px rgba(139, 92, 246, 0.2); }
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, transparent, var(--accent-purple), transparent);
            animation: rotate 12s linear infinite;
            opacity: 0.08;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 25px;
            margin-bottom: 25px;
        }

        .logo-svg {
            width: 90px;
            height: 90px;
            filter: drop-shadow(0 0 25px var(--accent-purple));
            animation: logoFloat 4s ease-in-out infinite;
        }

        @keyframes logoFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-8px) rotate(5deg); }
        }

        .main-title {
            font-family: 'Orbitron', monospace;
            font-size: clamp(2.8rem, 5vw, 4.5rem);
            font-weight: 900;
            background: linear-gradient(135deg, var(--text-light), var(--accent-purple), var(--light-purple), var(--text-light));
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: textGradient 4s ease-in-out infinite;
            text-shadow: 0 0 40px rgba(139, 92, 246, 0.3);
            margin-bottom: 15px;
            letter-spacing: 2px;
        }

        @keyframes textGradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .subtitle {
            font-size: clamp(1.1rem, 2vw, 1.4rem);
            color: var(--text-accent);
            opacity: 0.9;
            font-weight: 400;
            letter-spacing: 1.5px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        .credit-badge {
            position: absolute;
            top: 25px;
            right: 25px;
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-purple));
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.85rem;
            font-weight: 700;
            letter-spacing: 1px;
            box-shadow: 
                0 8px 20px var(--shadow-primary),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 1px solid var(--glass-border);
            animation: badgePulse 2s ease-in-out infinite;
        }

        @keyframes badgePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .nav-tab {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 2px solid var(--glass-border);
            border-radius: 15px;
            padding: 15px 25px;
            color: var(--text-light);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .nav-tab:hover {
            background: rgba(139, 92, 246, 0.2);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-purple));
            border-color: var(--accent-purple);
            box-shadow: 0 10px 25px var(--shadow-primary);
        }

        .main-content {
            flex: 1;
            display: grid;
            grid-template-columns: 1fr;
            gap: 35px;
            max-width: 900px;
            margin: 0 auto;
            width: 100%;
        }

        .tool-section {
            display: none;
        }

        .tool-section.active {
            display: block;
        }

        .control-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 2px solid var(--glass-border);
            border-radius: 20px;
            padding: 45px;
            box-shadow: 
                0 20px 40px var(--shadow-primary),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            position: relative;
            animation: panelGlow 4s ease-in-out infinite alternate;
        }

        @keyframes panelGlow {
            0% { box-shadow: 0 20px 40px var(--shadow-primary), inset 0 1px 0 rgba(255, 255, 255, 0.1); }
            100% { box-shadow: 0 25px 50px var(--shadow-primary), inset 0 1px 0 rgba(255, 255, 255, 0.15); }
        }

        .control-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--accent-purple), transparent);
            border-radius: 20px 20px 0 0;
            animation: borderGlow 3s ease-in-out infinite;
        }

        @keyframes borderGlow {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .form-group {
            margin-bottom: 35px;
        }

        .form-label {
            display: block;
            margin-bottom: 15px;
            font-weight: 700;
            color: var(--text-light);
            font-size: 1.15rem;
            letter-spacing: 0.5px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .prompt-container {
            position: relative;
        }

        .prompt-input {
            width: 100%;
            min-height: 130px;
            padding: 25px;
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid var(--glass-border);
            border-radius: 15px;
            color: var(--text-light);
            font-size: 1.05rem;
            font-family: inherit;
            resize: vertical;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .prompt-input:focus {
            outline: none;
            border-color: var(--accent-purple);
            box-shadow: 
                0 0 25px rgba(139, 92, 246, 0.4),
                inset 0 2px 10px rgba(0, 0, 0, 0.3);
            background: rgba(0, 0, 0, 0.6);
        }

        .prompt-input::placeholder {
            color: var(--text-muted);
            font-style: italic;
        }

        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin-bottom: 35px;
        }

        .select-wrapper {
            position: relative;
        }

        .custom-select {
            width: 100%;
            padding: 18px 25px;
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            color: var(--text-light);
            font-size: 1rem;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            appearance: none;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .custom-select:focus {
            outline: none;
            border-color: var(--accent-purple);
            box-shadow: 
                0 0 20px rgba(139, 92, 246, 0.3),
                inset 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .select-wrapper::after {
            content: '‚ñº';
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--accent-purple);
            pointer-events: none;
            font-size: 0.9rem;
            animation: arrowFloat 2s ease-in-out infinite;
        }

        @keyframes arrowFloat {
            0%, 100% { transform: translateY(-50%); }
            50% { transform: translateY(-45%); }
        }

        .generate-btn {
            width: 100%;
            padding: 25px;
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-purple), var(--light-purple));
            background-size: 300% 300%;
            border: none;
            border-radius: 15px;
            color: var(--text-light);
            font-size: 1.3rem;
            font-weight: 800;
            font-family: 'Orbitron', monospace;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 15px 35px var(--shadow-primary),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            animation: buttonPulse 3s ease-in-out infinite;
        }

        @keyframes buttonPulse {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .generate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 20px 45px var(--shadow-primary),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
            animation: buttonHover 1s ease infinite;
        }

        @keyframes buttonHover {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .generate-btn:active {
            transform: translateY(-1px);
        }

        .generate-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
            animation: none;
        }

        .btn-icon {
            margin-right: 12px;
            font-size: 1.5rem;
            animation: iconSpin 2s linear infinite;
        }

        @keyframes iconSpin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results-section {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 2px solid var(--glass-border);
            border-radius: 20px;
            padding: 45px;
            box-shadow: 
                0 20px 40px var(--shadow-primary),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            min-height: 450px;
            display: flex;
            flex-direction: column;
            animation: panelGlow 4s ease-in-out infinite alternate;
        }

        .results-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 35px;
            padding-bottom: 25px;
            border-bottom: 2px solid var(--glass-border);
        }

        .results-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.6rem;
            font-weight: 800;
            color: var(--text-light);
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .results-count {
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-purple));
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.95rem;
            font-weight: 700;
            box-shadow: 
                0 8px 20px var(--shadow-primary),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            animation: countPulse 2s ease-in-out infinite;
        }

        @keyframes countPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 30px;
            flex: 1;
        }

        .image-card {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--glass-border);
            border-radius: 20px;
            overflow: hidden;
            transition: all 0.4s ease;
            position: relative;
            backdrop-filter: blur(15px);
            box-shadow: 0 10px 30px var(--shadow-primary);
        }

        .image-card:hover {
            transform: translateY(-8px);
            box-shadow: 
                0 20px 50px var(--shadow-primary),
                0 0 30px rgba(139, 92, 246, 0.3);
            border-color: var(--accent-purple);
        }

        .image-container {
            position: relative;
            overflow: hidden;
        }

        .generated-image {
            width: 100%;
            height: 300px;
            object-fit: cover;
            transition: transform 0.4s ease;
        }

        .image-card:hover .generated-image {
            transform: scale(1.05);
        }

        .image-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(45, 27, 105, 0.8), rgba(139, 92, 246, 0.8));
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .image-card:hover .image-overlay {
            opacity: 1;
        }

        .download-btn {
            background: linear-gradient(135deg, var(--accent-purple), var(--light-purple));
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            color: var(--text-light);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            box-shadow: 0 8px 20px rgba(139, 92, 246, 0.4);
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 30px rgba(139, 92, 246, 0.6);
        }

        .image-info {
            padding: 20px;
        }

        .image-source {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .image-prompt {
            font-size: 0.9rem;
            color: var(--text-accent);
            line-height: 1.4;
            margin-bottom: 15px;
        }

        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 60px 20px;
            flex: 1;
        }

        .empty-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.7;
        }

        .empty-text {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-light);
            margin-bottom: 10px;
        }

        .empty-subtext {
            font-size: 1rem;
            color: var(--text-muted);
            max-width: 400px;
            line-height: 1.5;
        }

        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            flex: 1;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid var(--glass-border);
            border-top: 4px solid var(--accent-purple);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 25px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-light);
            margin-bottom: 10px;
        }

        .loading-subtext {
            font-size: 1rem;
            color: var(--text-muted);
        }

        .error-message {
            background: rgba(220, 38, 38, 0.1);
            border: 2px solid rgba(220, 38, 38, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            gap: 15px;
            color: #FCA5A5;
        }

        .reload-btn {
            background: linear-gradient(135deg, #DC2626, #B91C1C);
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            color: white;
            font-weight: 700;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s ease;
        }

        .reload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(220, 38, 38, 0.4);
        }

        .footer {
            text-align: center;
            padding: 40px 20px;
            margin-top: 60px;
            border-top: 2px solid var(--glass-border);
        }

        .footer-text {
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        .lnd-signature {
            background: linear-gradient(135deg, var(--accent-purple), var(--light-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
            letter-spacing: 1px;
        }

        /* Tools Grid for More Tools Section */
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .tool-card {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 2px solid var(--glass-border);
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .tool-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-purple);
            box-shadow: 0 15px 35px var(--shadow-primary);
        }

        .tool-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            display: block;
        }

        .tool-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-light);
            margin-bottom: 10px;
        }

        .tool-description {
            font-size: 0.9rem;
            color: var(--text-muted);
            line-height: 1.4;
        }

        /* File Input Styling */
        .file-input-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .file-input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-label {
            display: block;
            padding: 18px 25px;
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            color: var(--text-light);
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .file-input-label:hover {
            border-color: var(--accent-purple);
            background: rgba(0, 0, 0, 0.6);
        }

        /* Calculator Styles */
        .calc-btn {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 2px solid var(--glass-border);
            border-radius: 10px;
            color: var(--text-light);
            font-size: 1.1rem;
            font-weight: 600;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 50px;
        }

        .calc-btn:hover {
            transform: translateY(-2px);
            border-color: var(--accent-purple);
            box-shadow: 0 5px 15px rgba(139, 92, 246, 0.3);
        }

        .calc-btn:active {
            transform: translateY(0);
        }

        .calc-btn.operator {
            background: linear-gradient(135deg, var(--accent-purple), var(--light-purple));
            color: white;
            font-weight: 700;
        }

        .calc-btn.scientific {
            background: linear-gradient(135deg, #059669, #047857);
            color: white;
            font-size: 0.9rem;
        }

        .calculator-history {
            color: var(--text-muted);
        }

        .history-item {
            padding: 5px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
        }

        .history-expression {
            color: var(--text-light);
        }

        .history-result {
            color: var(--accent-purple);
            font-weight: 600;
        }

        /* Checkbox Styles */
        .checkbox-label {
            display: flex;
            align-items: center;
            color: var(--text-light);
            font-size: 0.9rem;
            cursor: pointer;
            position: relative;
            padding-left: 35px;
            user-select: none;
        }

        .checkbox-label input[type="checkbox"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .checkmark {
            position: absolute;
            left: 0;
            height: 20px;
            width: 20px;
            background: var(--glass-bg);
            border: 2px solid var(--glass-border);
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .checkbox-label:hover .checkmark {
            border-color: var(--accent-purple);
        }

        .checkbox-label input:checked ~ .checkmark {
            background: linear-gradient(135deg, var(--accent-purple), var(--light-purple));
            border-color: var(--accent-purple);
        }

        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }

        .checkbox-label input:checked ~ .checkmark:after {
            display: block;
        }

        .checkbox-label .checkmark:after {
            left: 6px;
            top: 2px;
            width: 6px;
            height: 10px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }

        /* Range Slider Styles */
        .range-slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: var(--glass-bg);
            outline: none;
            -webkit-appearance: none;
            margin: 15px 0;
        }

        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-purple), var(--light-purple));
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 10px rgba(139, 92, 246, 0.3);
        }

        .range-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-purple), var(--light-purple));
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 10px rgba(139, 92, 246, 0.3);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header {
                padding: 30px 20px;
                margin-bottom: 30px;
            }
            
            .logo-container {
                flex-direction: column;
                gap: 15px;
            }
            
            .logo-svg {
                width: 60px;
                height: 60px;
            }
            
            .main-title {
                font-size: 2rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .credit-badge {
                position: static;
                margin-top: 20px;
                display: inline-block;
            }
            
            .nav-tabs {
                flex-direction: column;
                gap: 10px;
            }
            
            .nav-tab {
                padding: 12px 20px;
                text-align: center;
            }
            
            .controls-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .control-panel,
            .results-section {
                padding: 25px;
            }
            
            .prompt-input {
                min-height: 110px;
                padding: 20px;
            }
            
            .generate-btn {
                padding: 20px;
                font-size: 1.1rem;
            }
            
            .tools-grid {
                grid-template-columns: 1fr;
            }
            
            .image-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Advanced Animations */
        .fade-in {
            animation: fadeIn 0.8s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-up {
            animation: slideUp 0.6s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Enhanced Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-darker);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-purple));
            border-radius: 5px;
            box-shadow: 0 0 10px var(--accent-purple);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, var(--secondary-purple), var(--light-purple));
        }
    </style>
</head>
<body>
    <!-- Enhanced Cosmic Particles Background -->
    <div class="cosmic-particles" id="particles"></div>

    <div class="container">
        <!-- Header Section -->
        <header class="header fade-in">
            <div class="header-content">
                <div class="logo-container">
                    <!-- Enhanced SVG Logo -->
                    <svg class="logo-svg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#8B5CF6;stop-opacity:1" />
                                <stop offset="50%" style="stop-color:#6366F1;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#2D1B69;stop-opacity:1" />
                            </linearGradient>
                            <filter id="glow">
                                <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
                                <feMerge> 
                                    <feMergeNode in="coloredBlur"/>
                                    <feMergeNode in="SourceGraphic"/>
                                </feMerge>
                            </filter>
                        </defs>
                        
                        <!-- Enhanced Neural Network Design -->
                        <circle cx="20" cy="30" r="5" fill="url(#logoGradient)" filter="url(#glow)">
                            <animate attributeName="opacity" values="0.4;1;0.4" dur="2.5s" repeatCount="indefinite"/>
                        </circle>
                        <circle cx="50" cy="20" r="6" fill="url(#logoGradient)" filter="url(#glow)">
                            <animate attributeName="opacity" values="1;0.4;1" dur="3s" repeatCount="indefinite"/>
                        </circle>
                        <circle cx="80" cy="35" r="5" fill="url(#logoGradient)" filter="url(#glow)">
                            <animate attributeName="opacity" values="0.4;1;0.4" dur="2.2s" repeatCount="indefinite"/>
                        </circle>
                        <circle cx="30" cy="60" r="7" fill="url(#logoGradient)" filter="url(#glow)">
                            <animate attributeName="opacity" values="1;0.4;1" dur="2.8s" repeatCount="indefinite"/>
                        </circle>
                        <circle cx="70" cy="65" r="6" fill="url(#logoGradient)" filter="url(#glow)">
                            <animate attributeName="opacity" values="0.4;1;0.4" dur="3.2s" repeatCount="indefinite"/>
                        </circle>
                        
                        <!-- Enhanced Connecting Lines -->
                        <line x1="20" y1="30" x2="50" y2="20" stroke="url(#logoGradient)" stroke-width="3" opacity="0.7">
                            <animate attributeName="opacity" values="0.3;0.9;0.3" dur="3.5s" repeatCount="indefinite"/>
                        </line>
                        <line x1="50" y1="20" x2="80" y2="35" stroke="url(#logoGradient)" stroke-width="3" opacity="0.7">
                            <animate attributeName="opacity" values="0.9;0.3;0.9" dur="3s" repeatCount="indefinite"/>
                        </line>
                        <line x1="20" y1="30" x2="30" y2="60" stroke="url(#logoGradient)" stroke-width="3" opacity="0.7">
                            <animate attributeName="opacity" values="0.3;0.9;0.3" dur="3.2s" repeatCount="indefinite"/>
                        </line>
                        <line x1="80" y1="35" x2="70" y2="65" stroke="url(#logoGradient)" stroke-width="3" opacity="0.7">
                            <animate attributeName="opacity" values="0.9;0.3;0.9" dur="2.8s" repeatCount="indefinite"/>
                        </line>
                        <line x1="30" y1="60" x2="70" y2="65" stroke="url(#logoGradient)" stroke-width="3" opacity="0.7">
                            <animate attributeName="opacity" values="0.3;0.9;0.3" dur="3.8s" repeatCount="indefinite"/>
                        </line>
                        
                        <!-- Enhanced Central AI Brain -->
                        <circle cx="50" cy="50" r="10" fill="none" stroke="url(#logoGradient)" stroke-width="4" filter="url(#glow)">
                            <animate attributeName="r" values="10;14;10" dur="4.5s" repeatCount="indefinite"/>
                        </circle>
                        <text x="50" y="56" text-anchor="middle" fill="url(#logoGradient)" font-family="Orbitron" font-size="14" font-weight="bold">AI</text>
                    </svg>
                    
                    <div>
                        <h1 class="main-title">LND Multi-Tool Suite</h1>
                        <p class="subtitle">‚óÜ AI-Powered Tools for Creative Professionals ‚óÜ</p>
                    </div>
                </div>
                <div class="credit-badge">Created by LND</div>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('textToImage')">üé® Text to Image</button>
            <button class="nav-tab" onclick="switchTab('webScrap')">üîç Web-Scrap Images</button>
            <button class="nav-tab" onclick="switchTab('textToSpeech')">üîä Text to Speech</button>
            <button class="nav-tab" onclick="switchTab('moreTools')">üõ†Ô∏è More Tools</button>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Text to Image Section -->
            <section id="textToImage" class="tool-section active">
                <div class="control-panel slide-up">
                    <form id="imageForm">
                        <div class="form-group">
                            <label for="prompt" class="form-label">‚ú® Describe Your Vision</label>
                            <div class="prompt-container">
                                <textarea 
                                    id="prompt" 
                                    class="prompt-input" 
                                    placeholder="Enter your creative prompt here... e.g., 'A majestic dragon soaring through a cyberpunk cityscape at sunset, neon lights reflecting off its scales, ultra-detailed, 8K resolution'"
                                    required
                                ></textarea>
                            </div>
                        </div>

                        <div class="controls-grid">
                            <div class="form-group">
                                <label for="imageCount" class="form-label">üéØ Number of Images</label>
                                <div class="select-wrapper">
                                    <select id="imageCount" class="custom-select">
                                        <option value="1">1 Image</option>
                                        <option value="2">2 Images</option>
                                        <option value="3">3 Images</option>
                                        <option value="4">4 Images</option>
                                        <option value="5">5 Images</option>
                                        <option value="6">6 Images</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="style" class="form-label">üé® Art Style</label>
                                <div class="select-wrapper">
                                    <select id="style" class="custom-select">
                                        <option value="">Default</option>
                                        <option value="photorealistic">Photorealistic</option>
                                        <option value="digital art">Digital Art</option>
                                        <option value="oil painting">Oil Painting</option>
                                        <option value="watercolor">Watercolor</option>
                                        <option value="anime">Anime Style</option>
                                        <option value="cyberpunk">Cyberpunk</option>
                                        <option value="steampunk">Steampunk</option>
                                        <option value="fantasy art">Fantasy Art</option>
                                        <option value="abstract">Abstract</option>
                                        <option value="minimalist">Minimalist</option>
                                        <option value="vintage">Vintage</option>
                                        <option value="noir">Film Noir</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="quality" class="form-label">‚ö° Quality Level</label>
                                <div class="select-wrapper">
                                    <select id="quality" class="custom-select">
                                        <option value="standard">Standard</option>
                                        <option value="high">High Quality</option>
                                        <option value="ultra">Ultra HD</option>
                                        <option value="masterpiece">Masterpiece</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="apiProvider" class="form-label">üîÆ AI Engine</label>
                                <div class="select-wrapper">
                                    <select id="apiProvider" class="custom-select">
                    <option value="random">üé≤ Shuffle Random (Recommended)</option>
                    <option value="pollinations">Pollinations AI</option>
                    <option value="deepai">DeepAI Engine</option>
                    <option value="huggingface">HuggingFace</option>
                    <option value="modelslab">ModelsLab (Uncensored)</option>
                    <option value="replicate">Replicate AI</option>
                    <option value="perchance">Perchance AI (Uncensored)</option>
                    <option value="raphaelai">Raphael AI (Unlimited)</option>
                    <option value="venice">Venice AI (Uncensored)</option>
                    <option value="nastia">Nastia AI (Uncensored)</option>
                    <option value="vadoo">Vadoo AI (Unrestricted)</option>
                    <option value="flux">FLUX.1 (Open Source)</option>
                    <option value="stablediffusion">Stable Diffusion (Free)</option>
                    <option value="aiscribble">AIScribble (Uncensored)</option>
                    <option value="nsfwai">NSFW AI Generator (18+)</option>
                    <option value="dynapictures">DynaPictures (Adult)</option>
                    <option value="gemini">Gemini 2.0 Flash (Uncensored)</option>
                    <option value="sexyai">SexyAI (18+ Content)</option>
                    <option value="pornpen">PornPen AI (Adult)</option>
                    <option value="soulgen">SoulGen (NSFW)</option>
                    <option value="dreamgf">DreamGF AI (Adult)</option>
                    <option value="icegirls">IceGirls AI (18+)</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="generate-btn" id="generateBtn">
                            <span class="btn-icon">üöÄ</span>
                            Generate Masterpiece
                        </button>
                    </form>
                </div>

                <div class="results-section slide-up">
                    <div class="results-header">
                        <h2 class="results-title">‚óÜ Generated Artworks ‚óÜ</h2>
                        <div class="results-count" id="resultsCount">0 Images</div>
                    </div>
                    
                    <div id="resultsContainer">
                        <div class="empty-state">
                            <div class="empty-icon">üé®</div>
                            <div class="empty-text">Ready to Create Magic</div>
                            <div class="empty-subtext">Enter your prompt above and let LND AI bring your imagination to life</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Web-Scrap Images Section -->
            <section id="webScrap" class="tool-section">
                <div class="control-panel slide-up">
                    <form id="scrapeForm">
                        <div class="form-group">
                            <label for="scrapeKeyword" class="form-label">üîç Search Keyword</label>
                            <input 
                                type="text"
                                id="scrapeKeyword" 
                                class="prompt-input" 
                                placeholder="Enter keyword to search for images... e.g., 'nature', 'technology', 'cats'"
                                required
                            />
                        </div>

                        <div class="controls-grid">
                            <div class="form-group">
                                <label for="scrapeCount" class="form-label">üìä Number of Images</label>
                                <div class="select-wrapper">
                                    <select id="scrapeCount" class="custom-select">
                                        <option value="10">10 Images</option>
                                        <option value="20" selected>20 Images</option>
                                        <option value="50">50 Images</option>
                                        <option value="100">100 Images</option>
                                        <option value="200">200 Images</option>
                                        <option value="500">500 Images</option>
                                        <option value="1000">1000 Images</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="scrapeQuality" class="form-label">‚ö° Image Quality</label>
                                <div class="select-wrapper">
                                    <select id="scrapeQuality" class="custom-select">
                                        <option value="medium">Medium Quality</option>
                                        <option value="high" selected>High Quality</option>
                                        <option value="original">Original Quality</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="generate-btn" id="scrapBtn">
                            <span class="btn-icon" id="scrapIcon">üîç</span>
                            <span id="scrapText">Start Web Scraping</span>
                        </button>
                    </form>
                </div>

                <div class="results-section slide-up">
                    <div class="results-header">
                        <h2 class="results-title">‚óÜ Web-Scraped Images (Max 6 Displayed) ‚óÜ</h2>
                        <div class="results-count" id="scrapResultsCount">0 Images</div>
                        <button id="downloadZipBtn" class="download-zip-btn" style="display: none;">
                            üì¶ Download All ZIP
                        </button>
                    </div>
                    
                    <div id="scrapResultsContainer">
                        <div class="empty-state">
                            <div class="empty-icon">üîç</div>
                            <div class="empty-text">Ready for Web Scraping</div>
                            <div class="empty-subtext">Enter a keyword above and let LND scrape high-quality images from the web</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Text to Speech Section -->
            <section id="textToSpeech" class="tool-section">
                <div class="control-panel slide-up">
                    <form id="ttsForm">
                        <div class="form-group">
                            <label for="ttsText" class="form-label">üìù Enter Text to Convert</label>
                            <div class="prompt-container">
                                <textarea 
                                    id="ttsText" 
                                    class="prompt-input" 
                                    placeholder="Enter the text you want to convert to speech..."
                                    required
                                ></textarea>
                            </div>
                        </div>

                        <div class="controls-grid">
                            <div class="form-group">
                                <label for="ttsVoice" class="form-label">üé§ Voice Type</label>
                                <div class="select-wrapper">
                                    <select id="ttsVoice" class="custom-select">
                                        <option value="male">Male Voice</option>
                                        <option value="female">Female Voice</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="ttsSpeed" class="form-label">‚ö° Speech Speed</label>
                                <div class="select-wrapper">
                                    <select id="ttsSpeed" class="custom-select">
                                        <option value="0.8">Slow</option>
                                        <option value="1" selected>Normal</option>
                                        <option value="1.2">Fast</option>
                                        <option value="1.5">Very Fast</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="ttsLanguage" class="form-label">üåç Language</label>
                                <div class="select-wrapper">
                                    <select id="ttsLanguage" class="custom-select">
                                        <option value="en-US">English (US)</option>
                                        <option value="en-GB">English (UK)</option>
                                        <option value="es-ES">Spanish</option>
                                        <option value="fr-FR">French</option>
                                        <option value="de-DE">German</option>
                                        <option value="it-IT">Italian</option>
                                        <option value="pt-BR">Portuguese</option>
                                        <option value="ja-JP">Japanese</option>
                                        <option value="ko-KR">Korean</option>
                                        <option value="zh-CN">Chinese</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="ttsProvider" class="form-label">üîä TTS Engine</label>
                                <div class="select-wrapper">
                                    <select id="ttsProvider" class="custom-select">
                                        <option value="browser" selected>Browser TTS</option>
                                        <option value="elevenlabs">ElevenLabs</option>
                                        <option value="openai">OpenAI TTS</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="generate-btn" id="ttsGenerateBtn">
                            <span class="btn-icon">üéµ</span>
                            Generate Speech
                        </button>
                    </form>
                </div>

                <div class="results-section slide-up">
                    <div class="results-header">
                        <h2 class="results-title">‚óÜ Generated Audio ‚óÜ</h2>
                        <div class="results-count" id="ttsResultsCount">0 Audio</div>
                    </div>
                    
                    <div id="ttsResultsContainer">
                        <div class="empty-state">
                            <div class="empty-icon">üéµ</div>
                            <div class="empty-text">Ready to Generate Speech</div>
                            <div class="empty-subtext">Enter your text above and convert it to natural-sounding speech</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- More Tools Section -->
            <section id="moreTools" class="tool-section">
                <div class="control-panel slide-up">
                    <h2 class="results-title" style="margin-bottom: 30px; text-align: center;">‚óÜ Additional Tools ‚óÜ</h2>
                    <div class="tools-grid">
                        <div class="tool-card" onclick="selectTool('imageResize')">
                            <span class="tool-icon">üìê</span>
                            <h3 class="tool-title">Image Resize</h3>
                            <p class="tool-description">Resize images to any dimensions while maintaining quality</p>
                        </div>
                        
                        <div class="tool-card" onclick="selectTool('imageConverter')">
                            <span class="tool-icon">üîÑ</span>
                            <h3 class="tool-title">Image Converter</h3>
                            <p class="tool-description">Convert between different image formats (JPG, PNG, WebP, etc.)</p>
                        </div>
                        
                        <div class="tool-card" onclick="selectTool('qrGenerator')">
                            <span class="tool-icon">üì±</span>
                            <h3 class="tool-title">QR Code Generator</h3>
                            <p class="tool-description">Create QR codes for URLs, text, or contact information</p>
                        </div>
                        
                        <div class="tool-card" onclick="selectTool('weatherCheck')">
                            <span class="tool-icon">üå§Ô∏è</span>
                            <h3 class="tool-title">Weather Check</h3>
                            <p class="tool-description">Get current weather information for any city</p>
                        </div>
                        
                        <div class="tool-card" onclick="selectTool('ipDetector')">
                            <span class="tool-icon">üåê</span>
                            <h3 class="tool-title">IP Detector</h3>
                            <p class="tool-description">Get detailed information about any IP address</p>
                        </div>
                        
                        <div class="tool-card" onclick="selectTool('randomImage')">
                            <span class="tool-icon">üé≤</span>
                            <h3 class="tool-title">Random Image</h3>
                            <p class="tool-description">Generate random images for inspiration or placeholders</p>
                        </div>
                        
                        <div class="tool-card" onclick="selectTool('calculator')">
                            <span class="tool-icon">üßÆ</span>
                            <h3 class="tool-title">Calculator</h3>
                            <p class="tool-description">Advanced calculator with scientific functions</p>
                        </div>
                        
                        <div class="tool-card" onclick="selectTool('hashConverter')">
                            <span class="tool-icon">üîê</span>
                            <h3 class="tool-title">Hash Converter</h3>
                            <p class="tool-description">Generate hashes with various algorithms and salt options</p>
                        </div>
                        
                        <div class="tool-card" onclick="selectTool('binaryConverter')">
                            <span class="tool-icon">üíª</span>
                            <h3 class="tool-title">Binary Converter</h3>
                            <p class="tool-description">Convert between binary, decimal, hex, and octal</p>
                        </div>
                        
                        <div class="tool-card" onclick="selectTool('passwordGenerator')">
                            <span class="tool-icon">üîë</span>
                            <h3 class="tool-title">Password Generator</h3>
                            <p class="tool-description">Generate secure passwords with custom options</p>
                        </div>
                    </div>
                </div>

                <!-- Individual Tool Interfaces (Hidden by default) -->
                <div id="imageResize" class="tool-interface" style="display: none;">
                    <div class="control-panel">
                        <button class="nav-tab" onclick="backToTools()" style="margin-bottom: 20px;">‚Üê Back to Tools</button>
                        <h3 class="results-title" style="margin-bottom: 20px;">Image Resize Tool</h3>
                        
                        <div class="form-group">
                            <label class="form-label">Upload Image</label>
                            <div class="file-input-wrapper">
                                <input type="file" id="resizeImageInput" class="file-input" accept="image/*">
                                <label for="resizeImageInput" class="file-input-label">Choose Image File</label>
                            </div>
                        </div>
                        
                        <div class="controls-grid">
                            <div class="form-group">
                                <label for="resizeWidth" class="form-label">Width (px)</label>
                                <input type="number" id="resizeWidth" class="prompt-input" style="min-height: auto; padding: 15px;" placeholder="800" min="1">
                            </div>
                            <div class="form-group">
                                <label for="resizeHeight" class="form-label">Height (px)</label>
                                <input type="number" id="resizeHeight" class="prompt-input" style="min-height: auto; padding: 15px;" placeholder="600" min="1">
                            </div>
                        </div>
                        
                        <button class="generate-btn" onclick="resizeImage()">
                            <span class="btn-icon">üìê</span>
                            Resize Image
                        </button>
                        
                        <div id="resizeResult" style="margin-top: 20px;"></div>
                    </div>
                </div>

                <div id="imageConverter" class="tool-interface" style="display: none;">
                    <div class="control-panel">
                        <button class="nav-tab" onclick="backToTools()" style="margin-bottom: 20px;">‚Üê Back to Tools</button>
                        <h3 class="results-title" style="margin-bottom: 20px;">Image Format Converter</h3>
                        
                        <div class="form-group">
                            <label class="form-label">Upload Image</label>
                            <div class="file-input-wrapper">
                                <input type="file" id="convertImageInput" class="file-input" accept="image/*">
                                <label for="convertImageInput" class="file-input-label">Choose Image File</label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="convertFormat" class="form-label">Convert to Format</label>
                            <div class="select-wrapper">
                                <select id="convertFormat" class="custom-select">
                                    <option value="jpeg">JPEG</option>
                                    <option value="png">PNG</option>
                                    <option value="webp">WebP</option>
                                </select>
                            </div>
                        </div>
                        
                        <button class="generate-btn" onclick="convertImage()">
                            <span class="btn-icon">üîÑ</span>
                            Convert Image
                        </button>
                        
                        <div id="convertResult" style="margin-top: 20px;"></div>
                    </div>
                </div>

                <div id="qrGenerator" class="tool-interface" style="display: none;">
                    <div class="control-panel">
                        <button class="nav-tab" onclick="backToTools()" style="margin-bottom: 20px;">‚Üê Back to Tools</button>
                        <h3 class="results-title" style="margin-bottom: 20px;">QR Code Generator</h3>
                        
                        <div class="form-group">
                            <label for="qrText" class="form-label">Text or URL</label>
                            <textarea id="qrText" class="prompt-input" placeholder="Enter text, URL, or any data to encode..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="qrSize" class="form-label">QR Code Size</label>
                            <div class="select-wrapper">
                                <select id="qrSize" class="custom-select">
                                    <option value="200">200x200</option>
                                    <option value="300" selected>300x300</option>
                                    <option value="400">400x400</option>
                                    <option value="500">500x500</option>
                                </select>
                            </div>
                        </div>
                        
                        <button class="generate-btn" onclick="generateQR()">
                            <span class="btn-icon">üì±</span>
                            Generate QR Code
                        </button>
                        
                        <div id="qrResult" style="margin-top: 20px;"></div>
                    </div>
                </div>

                <div id="weatherCheck" class="tool-interface" style="display: none;">
                    <div class="control-panel">
                        <button class="nav-tab" onclick="backToTools()" style="margin-bottom: 20px;">‚Üê Back to Tools</button>
                        <h3 class="results-title" style="margin-bottom: 20px;">Weather Information</h3>
                        
                        <div class="form-group">
                            <label for="cityName" class="form-label">City Name</label>
                            <input type="text" id="cityName" class="prompt-input" style="min-height: auto; padding: 15px;" placeholder="Enter city name...">
                        </div>
                        
                        <button class="generate-btn" onclick="getWeather()">
                            <span class="btn-icon">üå§Ô∏è</span>
                            Get Weather
                        </button>
                        
                        <div id="weatherResult" style="margin-top: 20px;"></div>
                    </div>
                </div>

                <div id="ipDetector" class="tool-interface" style="display: none;">
                    <div class="control-panel">
                        <button class="nav-tab" onclick="backToTools()" style="margin-bottom: 20px;">‚Üê Back to Tools</button>
                        <h3 class="results-title" style="margin-bottom: 20px;">IP Address Information</h3>
                        
                        <div class="form-group">
                            <label for="ipAddress" class="form-label">IP Address (leave empty for your IP)</label>
                            <input type="text" id="ipAddress" class="prompt-input" style="min-height: auto; padding: 15px;" placeholder="Enter IP address or leave empty...">
                        </div>
                        
                        <button class="generate-btn" onclick="getIPInfo()">
                            <span class="btn-icon">üåê</span>
                            Get IP Information
                        </button>
                        
                        <div id="ipResult" style="margin-top: 20px;"></div>
                    </div>
                </div>

                <div id="randomImage" class="tool-interface" style="display: none;">
                    <div class="control-panel">
                        <button class="nav-tab" onclick="backToTools()" style="margin-bottom: 20px;">‚Üê Back to Tools</button>
                        <h3 class="results-title" style="margin-bottom: 20px;">Random Image Generator</h3>
                        
                        <div class="controls-grid">
                            <div class="form-group">
                                <label for="randomCategory" class="form-label">Category</label>
                                <div class="select-wrapper">
                                    <select id="randomCategory" class="custom-select">
                                        <option value="">Any</option>
                                        <option value="nature">Nature</option>
                                        <option value="city">City</option>
                                        <option value="people">People</option>
                                        <option value="animals">Animals</option>
                                        <option value="food">Food</option>
                                        <option value="technology">Technology</option>
                                        <option value="abstract">Abstract</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="randomSize" class="form-label">Image Size</label>
                                <div class="select-wrapper">
                                    <select id="randomSize" class="custom-select">
                                        <option value="400x300">400x300</option>
                                        <option value="800x600" selected>800x600</option>
                                        <option value="1200x800">1200x800</option>
                                        <option value="1920x1080">1920x1080</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <button class="generate-btn" onclick="generateRandomImage()">
                            <span class="btn-icon">üé≤</span>
                            Generate Random Image
                        </button>
                        
                        <div id="randomResult" style="margin-top: 20px;"></div>
                    </div>
                </div>

                <!-- Calculator Tool Interface -->
                <div id="calculator" class="tool-interface" style="display: none;">
                    <div class="control-panel">
                        <button class="nav-tab" onclick="backToTools()" style="margin-bottom: 20px;">‚Üê Back to Tools</button>
                        <h3 class="results-title" style="margin-bottom: 20px;">Advanced Calculator</h3>
                        
                        <div class="calculator-container" style="max-width: 400px; margin: 0 auto;">
                            <div class="calculator-display">
                                <input type="text" id="calcDisplay" class="prompt-input" style="min-height: auto; padding: 20px; font-size: 1.5rem; text-align: right; font-family: 'Courier New', monospace;" readonly>
                            </div>
                            
                            <div class="calculator-buttons" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 20px;">
                                <!-- Row 1 -->
                                <button class="calc-btn" onclick="clearCalculator()" style="background: rgba(220, 38, 38, 0.8); grid-column: span 2;">Clear</button>
                                <button class="calc-btn" onclick="deleteLast()">‚å´</button>
                                <button class="calc-btn operator" onclick="appendToDisplay('/')" title="Divide">√∑</button>
                                
                                <!-- Row 2 -->
                                <button class="calc-btn" onclick="appendToDisplay('7')">7</button>
                                <button class="calc-btn" onclick="appendToDisplay('8')">8</button>
                                <button class="calc-btn" onclick="appendToDisplay('9')">9</button>
                                <button class="calc-btn operator" onclick="appendToDisplay('*')" title="Multiply">√ó</button>
                                
                                <!-- Row 3 -->
                                <button class="calc-btn" onclick="appendToDisplay('4')">4</button>
                                <button class="calc-btn" onclick="appendToDisplay('5')">5</button>
                                <button class="calc-btn" onclick="appendToDisplay('6')">6</button>
                                <button class="calc-btn operator" onclick="appendToDisplay('-')" title="Subtract">‚àí</button>
                                
                                <!-- Row 4 -->
                                <button class="calc-btn" onclick="appendToDisplay('1')">1</button>
                                <button class="calc-btn" onclick="appendToDisplay('2')">2</button>
                                <button class="calc-btn" onclick="appendToDisplay('3')">3</button>
                                <button class="calc-btn operator" onclick="appendToDisplay('+')" title="Add">+</button>
                                
                                <!-- Row 5 -->
                                <button class="calc-btn" onclick="appendToDisplay('0')" style="grid-column: span 2;">0</button>
                                <button class="calc-btn" onclick="appendToDisplay('.')">.</button>
                                <button class="calc-btn operator" onclick="calculateResult()" style="background: rgba(34, 197, 94, 0.8);" title="Equals">=</button>
                                
                                <!-- Scientific Functions Row -->
                                <button class="calc-btn scientific" onclick="appendFunction('Math.sin(')" title="Sine">sin</button>
                                <button class="calc-btn scientific" onclick="appendFunction('Math.cos(')" title="Cosine">cos</button>
                                <button class="calc-btn scientific" onclick="appendFunction('Math.tan(')" title="Tangent">tan</button>
                                <button class="calc-btn scientific" onclick="appendFunction('Math.log(')" title="Natural Log">ln</button>
                                
                                <button class="calc-btn scientific" onclick="appendFunction('Math.sqrt(')" title="Square Root">‚àö</button>
                                <button class="calc-btn scientific" onclick="appendToDisplay('**')" title="Power">x^y</button>
                                <button class="calc-btn scientific" onclick="appendToDisplay('Math.PI')" title="Pi">œÄ</button>
                                <button class="calc-btn scientific" onclick="appendToDisplay('Math.E')" title="Euler's number">e</button>
                            </div>
                            
                            <div class="calculator-history" style="margin-top: 20px;">
                                <h4 style="color: var(--text-light); margin-bottom: 10px;">History</h4>
                                <div id="calcHistory" style="max-height: 150px; overflow-y: auto; background: rgba(0, 0, 0, 0.3); padding: 10px; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 0.9rem;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Hash Converter Tool Interface -->
                <div id="hashConverter" class="tool-interface" style="display: none;">
                    <div class="control-panel">
                        <button class="nav-tab" onclick="backToTools()" style="margin-bottom: 20px;">‚Üê Back to Tools</button>
                        <h3 class="results-title" style="margin-bottom: 20px;">Hash Converter & Encryption</h3>
                        
                        <div class="form-group">
                            <label for="hashInput" class="form-label">Input Text</label>
                            <textarea id="hashInput" class="prompt-input" placeholder="Enter text to hash..." style="min-height: 100px;"></textarea>
                        </div>
                        
                        <div class="controls-grid">
                            <div class="form-group">
                                <label for="hashAlgorithm" class="form-label">Hash Algorithm</label>
                                <div class="select-wrapper">
                                    <select id="hashAlgorithm" class="custom-select">
                                        <option value="md5">MD5</option>
                                        <option value="sha1">SHA-1</option>
                                        <option value="sha256" selected>SHA-256</option>
                                        <option value="sha512">SHA-512</option>
                                        <option value="bcrypt">Bcrypt (with salt)</option>
                                        <option value="pbkdf2">PBKDF2 (with salt)</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="hashSalt" class="form-label">Salt (Optional)</label>
                                <input type="text" id="hashSalt" class="prompt-input" style="min-height: auto; padding: 15px;" placeholder="Enter custom salt...">
                            </div>
                        </div>
                        
                        <div class="controls-grid">
                            <button class="generate-btn" onclick="generateHash()">
                                <span class="btn-icon">üîê</span>
                                Generate Hash
                            </button>
                            
                            <button class="generate-btn" onclick="generateRandomSalt()" style="background: linear-gradient(135deg, #059669, #047857);">
                                <span class="btn-icon">üé≤</span>
                                Generate Salt
                            </button>
                        </div>
                        
                        <div id="hashResult" style="margin-top: 20px;"></div>
                    </div>
                </div>

                <!-- Binary Converter Tool Interface -->
                <div id="binaryConverter" class="tool-interface" style="display: none;">
                    <div class="control-panel">
                        <button class="nav-tab" onclick="backToTools()" style="margin-bottom: 20px;">‚Üê Back to Tools</button>
                        <h3 class="results-title" style="margin-bottom: 20px;">Binary Converter</h3>
                        
                        <div class="form-group">
                            <label for="binaryInput" class="form-label">Input Value</label>
                            <textarea id="binaryInput" class="prompt-input" placeholder="Enter value to convert..." style="min-height: 100px;"></textarea>
                        </div>
                        
                        <div class="controls-grid">
                            <div class="form-group">
                                <label for="inputFormat" class="form-label">Input Format</label>
                                <div class="select-wrapper">
                                    <select id="inputFormat" class="custom-select">
                                        <option value="decimal" selected>Decimal (Base 10)</option>
                                        <option value="binary">Binary (Base 2)</option>
                                        <option value="octal">Octal (Base 8)</option>
                                        <option value="hexadecimal">Hexadecimal (Base 16)</option>
                                        <option value="text">Text (ASCII)</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="outputFormat" class="form-label">Output Format</label>
                                <div class="select-wrapper">
                                    <select id="outputFormat" class="custom-select">
                                        <option value="binary" selected>Binary (Base 2)</option>
                                        <option value="decimal">Decimal (Base 10)</option>
                                        <option value="octal">Octal (Base 8)</option>
                                        <option value="hexadecimal">Hexadecimal (Base 16)</option>
                                        <option value="text">Text (ASCII)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="controls-grid">
                            <button class="generate-btn" onclick="convertBinary()">
                                <span class="btn-icon">üíª</span>
                                Convert
                            </button>
                            
                            <button class="generate-btn" onclick="clearBinaryConverter()" style="background: linear-gradient(135deg, #DC2626, #B91C1C);">
                                <span class="btn-icon">üóëÔ∏è</span>
                                Clear
                            </button>
                        </div>
                        
                        <div id="binaryResult" style="margin-top: 20px;"></div>
                    </div>
                </div>

                <!-- Password Generator Tool Interface -->
                <div id="passwordGenerator" class="tool-interface" style="display: none;">
                    <div class="control-panel">
                        <button class="nav-tab" onclick="backToTools()" style="margin-bottom: 20px;">‚Üê Back to Tools</button>
                        <h3 class="results-title" style="margin-bottom: 20px;">Secure Password Generator</h3>
                        
                        <div class="controls-grid">
                            <div class="form-group">
                                <label for="passwordLength" class="form-label">Password Length</label>
                                <input type="range" id="passwordLength" min="4" max="128" value="16" class="range-slider" oninput="updateLengthDisplay()">
                                <div style="text-align: center; margin-top: 10px;">
                                    <span id="lengthDisplay" style="color: var(--accent-purple); font-weight: 600; font-size: 1.2rem;">16</span> characters
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="passwordCount" class="form-label">Number of Passwords</label>
                                <div class="select-wrapper">
                                    <select id="passwordCount" class="custom-select">
                                        <option value="1" selected>1 Password</option>
                                        <option value="5">5 Passwords</option>
                                        <option value="10">10 Passwords</option>
                                        <option value="20">20 Passwords</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Character Types</label>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="includeUppercase" checked>
                                    <span class="checkmark"></span>
                                    Uppercase Letters (A-Z)
                                </label>
                                
                                <label class="checkbox-label">
                                    <input type="checkbox" id="includeLowercase" checked>
                                    <span class="checkmark"></span>
                                    Lowercase Letters (a-z)
                                </label>
                                
                                <label class="checkbox-label">
                                    <input type="checkbox" id="includeNumbers" checked>
                                    <span class="checkmark"></span>
                                    Numbers (0-9)
                                </label>
                                
                                <label class="checkbox-label">
                                    <input type="checkbox" id="includeSymbols" checked>
                                    <span class="checkmark"></span>
                                    Symbols (!@#$%^&*)
                                </label>
                                
                                <label class="checkbox-label">
                                    <input type="checkbox" id="includeExtendedSymbols">
                                    <span class="checkmark"></span>
                                    Extended Symbols
                                </label>
                                
                                <label class="checkbox-label">
                                    <input type="checkbox" id="excludeSimilar">
                                    <span class="checkmark"></span>
                                    Exclude Similar (0,O,l,1)
                                </label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="customChars" class="form-label">Custom Characters (Optional)</label>
                            <input type="text" id="customChars" class="prompt-input" style="min-height: auto; padding: 15px;" placeholder="Add custom characters...">
                        </div>
                        
                        <div class="controls-grid">
                            <button class="generate-btn" onclick="generatePasswords()">
                                <span class="btn-icon">üîë</span>
                                Generate Passwords
                            </button>
                            
                            <button class="generate-btn" onclick="generatePassphrase()" style="background: linear-gradient(135deg, #059669, #047857);">
                                <span class="btn-icon">üìù</span>
                                Generate Passphrase
                            </button>
                        </div>
                        
                        <div id="passwordResult" style="margin-top: 20px;"></div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p class="footer-text">
                Powered by <span class="lnd-signature">LND</span> ‚Ä¢ Advanced AI Multi-Tool Suite
            </p>
        </footer>
    </div>

    <script>
        // Global variables
        let isGenerating = false;
        let generatedImages = [];
        let currentTool = null;

        // Initialize particles and setup on page load
        document.addEventListener('DOMContentLoaded', function() {
            createParticles();
            setupEventListeners();
        });

        // Create enhanced floating particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 60;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 8 + 's';
                particle.style.animationDuration = (Math.random() * 4 + 4) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            const imageForm = document.getElementById('imageForm');
            const ttsForm = document.getElementById('ttsForm');
            
            imageForm.addEventListener('submit', handleImageFormSubmit);
            ttsForm.addEventListener('submit', handleTTSFormSubmit);

            // Keyboard shortcuts
            document.addEventListener('keydown', function(event) {
                // Ctrl/Cmd + Enter to generate
                if ((event.ctrlKey || event.metaKey) && event.key === 'Enter') {
                    event.preventDefault();
                    if (!isGenerating) {
                        const activeSection = document.querySelector('.tool-section.active');
                        if (activeSection.id === 'textToImage') {
                            handleImageFormSubmit(event);
                        } else if (activeSection.id === 'textToSpeech') {
                            handleTTSFormSubmit(event);
                        }
                    }
                }
            });
        }

        // Tab switching functionality
        function switchTab(tabName) {
            // Remove active class from all tabs and sections
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tool-section').forEach(section => section.classList.remove('active'));
            
            // Add active class to clicked tab and corresponding section
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            // Reset any tool interfaces in more tools section
            if (tabName === 'moreTools') {
                backToTools();
            }
            
            // Setup web-scrap listeners when switching to webScrap tab
            if (tabName === 'webScrap') {
                setupWebScrapListeners();
            }
        }

        // Tool selection in more tools section
        function selectTool(toolName) {
            currentTool = toolName;
            
            // Hide tools grid
            document.querySelector('.tools-grid').parentElement.style.display = 'none';
            
            // Show selected tool interface
            document.getElementById(toolName).style.display = 'block';
        }

        function backToTools() {
            currentTool = null;
            
            // Show tools grid
            document.querySelector('.tools-grid').parentElement.style.display = 'block';
            
            // Hide all tool interfaces
            document.querySelectorAll('.tool-interface').forEach(interface => {
                interface.style.display = 'none';
            });
        }

        // Handle image form submission
        async function handleImageFormSubmit(event) {
            event.preventDefault();
            
            if (isGenerating) return;
            
            const prompt = document.getElementById('prompt').value.trim();
            if (!prompt) {
                showError('Please enter a prompt to generate images.');
                return;
            }

            const imageCount = parseInt(document.getElementById('imageCount').value);
            const style = document.getElementById('style').value;
            const quality = document.getElementById('quality').value;
            const apiProvider = document.getElementById('apiProvider').value;

            await generateImages(prompt, imageCount, style, quality, apiProvider);
        }

        // Handle TTS form submission
        async function handleTTSFormSubmit(event) {
            event.preventDefault();
            
            if (isGenerating) return;
            
            const text = document.getElementById('ttsText').value.trim();
            if (!text) {
                showTTSError('Please enter text to convert to speech.');
                return;
            }

            const voice = document.getElementById('ttsVoice').value;
            const speed = parseFloat(document.getElementById('ttsSpeed').value);
            const language = document.getElementById('ttsLanguage').value;
            const provider = document.getElementById('ttsProvider').value;

            await generateSpeech(text, voice, speed, language, provider);
        }

        // Main image generation function
        async function generateImages(prompt, count, style, quality, provider) {
            setGenerating(true, 'image');
            showLoading();

            try {
                const images = [];
                const enhancedPrompt = enhancePrompt(prompt, style, quality);

                for (let i = 0; i < count; i++) {
                    let imageData = null;
                    let currentProvider = provider;
                    let attempts = 0;
                    const maxAttempts = 2;

                    while (imageData === null && attempts < maxAttempts) {
                        try {
                            imageData = await generateSingleImage(enhancedPrompt, currentProvider, i);
                        } catch (error) {
                            console.error(`Attempt ${attempts + 1} with ${currentProvider} failed:`, error);
                            attempts++;
                            if (attempts < maxAttempts) {
                                // Try a different provider for retry
                                if (currentProvider === 'pollinations') {
                                    currentProvider = 'deepai';
                                } else if (currentProvider === 'deepai') {
                                    currentProvider = 'huggingface';
                                } else if (currentProvider === 'huggingface') {
                                    currentProvider = 'pollinations';
                                } else if (currentProvider === 'modelslab') {
                                    currentProvider = 'pollinations';
                                } else {
                                    currentProvider = 'pollinations';
                                }
                            }
                        }
                    }

                    if (imageData) {
                        images.push(imageData);
                    }
                }

                if (images.length === 0) {
                    showError('Failed to generate any images. Please try again with a different prompt or provider.', true);
                } else {
                    generatedImages = images;
                    updateResults(images);
                }

            } catch (error) {
                console.error('Generation error:', error);
                showError('An unexpected error occurred. Please try again.', true);
            } finally {
                setGenerating(false, 'image');
            }
        }

        // Generate single image with different providers
        async function generateSingleImage(prompt, provider, index) {
            const seed = hashCode(prompt + index + Date.now());
            
            // If random is selected, pick a random provider
            if (provider === 'random') {
                const availableProviders = [
                    'pollinations', 'deepai', 'huggingface', 'modelslab', 'replicate',
                    'perchance', 'raphaelai', 'venice', 'nastia', 'vadoo', 'flux',
                    'stablediffusion', 'aiscribble', 'nsfwai', 'dynapictures', 'gemini',
                    'sexyai', 'pornpen', 'soulgen', 'dreamgf', 'icegirls'
                ];
                provider = availableProviders[Math.floor(Math.random() * availableProviders.length)];
                console.log(`Random provider selected: ${provider}`);
            }
            
            switch (provider) {
                case 'pollinations':
                    return await generateWithPollinations(prompt, seed);
                case 'deepai':
                    return await generateWithDeepAI(prompt, seed);
                case 'huggingface':
                    return await generateWithHuggingFace(prompt, seed);
                case 'modelslab':
                    return await generateWithModelsLab(prompt, seed);
                case 'replicate':
                    return await generateWithReplicate(prompt, seed);
                case 'perchance':
                    return await generateWithPerchance(prompt, seed);
                case 'raphaelai':
                    return await generateWithRaphaelAI(prompt, seed);
                case 'venice':
                    return await generateWithVenice(prompt, seed);
                case 'nastia':
                    return await generateWithNastia(prompt, seed);
                case 'vadoo':
                    return await generateWithVadoo(prompt, seed);
                case 'flux':
                    return await generateWithFlux(prompt, seed);
                case 'stablediffusion':
                    return await generateWithStableDiffusion(prompt, seed);
                case 'aiscribble':
                    return await generateWithAIScribble(prompt, seed);
                case 'nsfwai':
                    return await generateWithNSFWAI(prompt, seed);
                case 'dynapictures':
                    return await generateWithDynaPictures(prompt, seed);
                case 'gemini':
                    return await generateWithGemini(prompt, seed);
                case 'sexyai':
                    return await generateWithSexyAI(prompt, seed);
                case 'pornpen':
                    return await generateWithPornPen(prompt, seed);
                case 'soulgen':
                    return await generateWithSoulGen(prompt, seed);
                case 'dreamgf':
                    return await generateWithDreamGF(prompt, seed);
                case 'icegirls':
                    return await generateWithIceGirls(prompt, seed);
                default:
                    return await generateWithPollinations(prompt, seed);
            }
        }

        // Pollinations API (Free, no API key required)
        async function generateWithPollinations(prompt, seed) {
            const encodedPrompt = encodeURIComponent(prompt);
            const imageUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?seed=${seed}&width=1024&height=1024&nologo=true`;
            
            await validateImageUrl(imageUrl, 'pollinations');
            
            return {
                url: imageUrl,
                prompt: prompt,
                seed: seed,
                provider: 'pollinations'
            };
        }

        // DeepAI API (Free tier available)
        async function generateWithDeepAI(prompt, seed) {
            try {
                const response = await fetch('https://api.deepai.org/api/text2img', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Api-Key': 'quickstart-QUdJIGlzIGNvbWluZy4uLi4K' // Free tier key
                    },
                    body: JSON.stringify({
                        text: prompt
                    })
                });

                if (!response.ok) {
                    throw new Error(`DeepAI API error: ${response.status}`);
                }

                const data = await response.json();
                await validateImageUrl(data.output_url, 'deepai');
                
                return {
                    url: data.output_url,
                    prompt: prompt,
                    seed: seed,
                    provider: 'deepai'
                };
            } catch (error) {
                console.error('DeepAI generation failed:', error);
                throw error;
            }
        }

        // HuggingFace API (Free tier available)
        async function generateWithHuggingFace(prompt, seed) {
            const encodedPrompt = encodeURIComponent(prompt);
            const imageUrl = `https://api-inference.huggingface.co/models/runwayml/stable-diffusion-v1-5?prompt=${encodedPrompt}&seed=${seed}`;
            
            try {
                const response = await fetch(imageUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        inputs: prompt,
                        parameters: {
                            seed: seed,
                            num_inference_steps: 20
                        }
                    })
                });

                if (!response.ok) {
                    throw new Error(`HuggingFace API error: ${response.status}`);
                }

                const blob = await response.blob();
                const imageUrl2 = URL.createObjectURL(blob);
                
                return {
                    url: imageUrl2,
                    prompt: prompt,
                    seed: seed,
                    provider: 'huggingface'
                };
            } catch (error) {
                console.error('HuggingFace generation failed:', error);
                // Fallback to a simple HF inference endpoint
                const fallbackUrl = `https://api-inference.huggingface.co/models/stabilityai/stable-diffusion-2-1`;
                const imageUrl = `${fallbackUrl}?inputs=${encodedPrompt}&seed=${seed}`;
                
                await validateImageUrl(imageUrl, 'huggingface');
                
                return {
                    url: imageUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'huggingface'
                };
            }
        }

        // ModelsLab API (Uncensored - requires API key, fallback to free service)
        async function generateWithModelsLab(prompt, seed) {
            try {
                // Try ModelsLab API first (would require API key)
                // For demo purposes, we'll use a fallback to another uncensored service
                
                // Fallback to a free uncensored service
                const encodedPrompt = encodeURIComponent(prompt + ', uncensored, detailed');
                const imageUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?seed=${seed}&width=1024&height=1024&nologo=true&model=flux`;
                
                await validateImageUrl(imageUrl, 'modelslab');
                
                return {
                    url: imageUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'modelslab'
                };
            } catch (error) {
                console.error('ModelsLab generation failed:', error);
                throw error;
            }
        }

        // Replicate API (requires API key, fallback to free service)
        async function generateWithReplicate(prompt, seed) {
            // For demo purposes, fallback to Pollinations
            return await generateWithPollinations(prompt, seed);
        }

        // Perchance AI (Uncensored)
        async function generateWithPerchance(prompt, seed) {
            try {
                // Perchance uses a different approach, we'll simulate their API
                const encodedPrompt = encodeURIComponent(prompt + ', uncensored, high quality');
                const imageUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?seed=${seed}&width=1024&height=1024&nologo=true&model=flux&enhance=true`;
                
                await validateImageUrl(imageUrl, 'perchance');
                
                return {
                    url: imageUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'perchance'
                };
            } catch (error) {
                console.error('Perchance generation failed:', error);
                throw error;
            }
        }

        // Raphael AI (Unlimited)
        async function generateWithRaphaelAI(prompt, seed) {
            try {
                // Raphael AI simulation using free service
                const encodedPrompt = encodeURIComponent(prompt + ', artistic, detailed');
                const imageUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?seed=${seed}&width=1024&height=1024&nologo=true&model=turbo`;
                
                await validateImageUrl(imageUrl, 'raphaelai');
                
                return {
                    url: imageUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'raphaelai'
                };
            } catch (error) {
                console.error('Raphael AI generation failed:', error);
                throw error;
            }
        }

        // Venice AI (Uncensored)
        async function generateWithVenice(prompt, seed) {
            try {
                // Venice AI simulation using free service
                const encodedPrompt = encodeURIComponent(prompt + ', uncensored, private, high quality');
                const imageUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?seed=${seed}&width=1024&height=1024&nologo=true&model=flux-dev`;
                
                await validateImageUrl(imageUrl, 'venice');
                
                return {
                    url: imageUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'venice'
                };
            } catch (error) {
                console.error('Venice AI generation failed:', error);
                throw error;
            }
        }

        // Nastia AI (Uncensored)
        async function generateWithNastia(prompt, seed) {
            try {
                // Nastia AI simulation using free service
                const encodedPrompt = encodeURIComponent(prompt + ', uncensored, realistic, detailed');
                const imageUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?seed=${seed}&width=1024&height=1024&nologo=true&model=flux-realism`;
                
                await validateImageUrl(imageUrl, 'nastia');
                
                return {
                    url: imageUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'nastia'
                };
            } catch (error) {
                console.error('Nastia AI generation failed:', error);
                throw error;
            }
        }

        // Vadoo AI (Unrestricted)
        async function generateWithVadoo(prompt, seed) {
            try {
                // Vadoo AI simulation using free service
                const encodedPrompt = encodeURIComponent(prompt + ', unrestricted, no filters, high quality');
                const imageUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?seed=${seed}&width=1024&height=1024&nologo=true&model=flux-schnell`;
                
                await validateImageUrl(imageUrl, 'vadoo');
                
                return {
                    url: imageUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'vadoo'
                };
            } catch (error) {
                console.error('Vadoo AI generation failed:', error);
                throw error;
            }
        }

        // FLUX.1 (Open Source)
        async function generateWithFlux(prompt, seed) {
            try {
                // FLUX.1 simulation using free service
                const encodedPrompt = encodeURIComponent(prompt + ', flux model, open source, high quality');
                const imageUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?seed=${seed}&width=1024&height=1024&nologo=true&model=flux`;
                
                await validateImageUrl(imageUrl, 'flux');
                
                return {
                    url: imageUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'flux'
                };
            } catch (error) {
                console.error('FLUX generation failed:', error);
                throw error;
            }
        }

        // Stable Diffusion (Free)
        async function generateWithStableDiffusion(prompt, seed) {
            try {
                // Stable Diffusion simulation using free service
                const encodedPrompt = encodeURIComponent(prompt + ', stable diffusion, high quality, detailed');
                const imageUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?seed=${seed}&width=1024&height=1024&nologo=true&model=stable-diffusion`;
                
                await validateImageUrl(imageUrl, 'stablediffusion');
                
                return {
                    url: imageUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'stablediffusion'
                };
            } catch (error) {
                console.error('Stable Diffusion generation failed:', error);
                throw error;
            }
        }

        // SexyAI (18+ Content)
        async function generateWithSexyAI(prompt, seed) {
            try {
                // SexyAI simulation using free service with adult content
                const encodedPrompt = encodeURIComponent(prompt + ', sexy, adult content, uncensored, high quality');
                const imageUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?seed=${seed}&width=1024&height=1024&nologo=true&model=flux-realism`;
                
                await validateImageUrl(imageUrl, 'sexyai');
                
                return {
                    url: imageUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'sexyai'
                };
            } catch (error) {
                console.error('SexyAI generation failed:', error);
                throw error;
            }
        }

        // PornPen AI (Adult)
        async function generateWithPornPen(prompt, seed) {
            try {
                // PornPen AI simulation using free service with adult content
                const encodedPrompt = encodeURIComponent(prompt + ', adult, explicit, uncensored, realistic');
                const imageUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?seed=${seed}&width=1024&height=1024&nologo=true&model=flux-dev`;
                
                await validateImageUrl(imageUrl, 'pornpen');
                
                return {
                    url: imageUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'pornpen'
                };
            } catch (error) {
                console.error('PornPen AI generation failed:', error);
                throw error;
            }
        }

        // SoulGen (NSFW)
        async function generateWithSoulGen(prompt, seed) {
            try {
                // SoulGen simulation using free service with NSFW content
                const encodedPrompt = encodeURIComponent(prompt + ', nsfw, uncensored, detailed, high quality');
                const imageUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?seed=${seed}&width=1024&height=1024&nologo=true&model=flux-schnell`;
                
                await validateImageUrl(imageUrl, 'soulgen');
                
                return {
                    url: imageUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'soulgen'
                };
            } catch (error) {
                console.error('SoulGen generation failed:', error);
                throw error;
            }
        }

        // DreamGF AI (Adult)
        async function generateWithDreamGF(prompt, seed) {
            try {
                // DreamGF AI simulation using free service with adult content
                const encodedPrompt = encodeURIComponent(prompt + ', adult content, girlfriend, uncensored, realistic');
                const imageUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?seed=${seed}&width=1024&height=1024&nologo=true&model=flux-realism`;
                
                await validateImageUrl(imageUrl, 'dreamgf');
                
                return {
                    url: imageUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'dreamgf'
                };
            } catch (error) {
                console.error('DreamGF AI generation failed:', error);
                throw error;
            }
        }

        // IceGirls AI (18+)
        async function generateWithIceGirls(prompt, seed) {
            try {
                // IceGirls AI simulation using free service with 18+ content
                const encodedPrompt = encodeURIComponent(prompt + ', 18+, adult, uncensored, beautiful, detailed');
                const imageUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?seed=${seed}&width=1024&height=1024&nologo=true&model=flux-dev`;
                
                await validateImageUrl(imageUrl, 'icegirls');
                
                return {
                    url: imageUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'icegirls'
                };
            } catch (error) {
                console.error('IceGirls AI generation failed:', error);
                throw error;
            }
        }

        // Validate image URL by attempting to load it
        async function validateImageUrl(imageUrl, provider) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.onload = () => resolve(imageUrl);
                img.onerror = () => reject(new Error(`Image failed to load from ${provider}`));
                img.src = imageUrl;
                
                // Timeout after 15 seconds
                setTimeout(() => reject(new Error(`Image load timeout from ${provider}`)), 15000);
            });
        }

        // AIScribble API (Uncensored)
        async function generateWithAIScribble(prompt, seed) {
            try {
                const response = await fetch('https://api.aiscribble.com/v1/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        prompt: prompt,
                        seed: seed,
                        width: 512,
                        height: 512,
                        steps: 20
                    })
                });

                if (!response.ok) {
                    throw new Error(`AIScribble API error: ${response.status}`);
                }

                const data = await response.json();
                await validateImageUrl(data.image_url, 'aiscribble');
                
                return {
                    url: data.image_url,
                    prompt: prompt,
                    seed: seed,
                    provider: 'aiscribble'
                };
            } catch (error) {
                console.error('AIScribble generation failed:', error);
                // Fallback to a working API
                const fallbackUrl = `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt)}?seed=${seed}&width=512&height=512&nologo=true`;
                await validateImageUrl(fallbackUrl, 'aiscribble-fallback');
                
                return {
                    url: fallbackUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'aiscribble'
                };
            }
        }

        // NSFW AI Generator (18+)
        async function generateWithNSFWAI(prompt, seed) {
            try {
                const response = await fetch('https://api.nsfwai.com/v1/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        prompt: prompt,
                        seed: seed,
                        nsfw: true,
                        width: 512,
                        height: 512
                    })
                });

                if (!response.ok) {
                    throw new Error(`NSFW AI API error: ${response.status}`);
                }

                const data = await response.json();
                await validateImageUrl(data.output_url, 'nsfwai');
                
                return {
                    url: data.output_url,
                    prompt: prompt,
                    seed: seed,
                    provider: 'nsfwai'
                };
            } catch (error) {
                console.error('NSFW AI generation failed:', error);
                // Fallback to a working API
                const fallbackUrl = `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt)}?seed=${seed}&width=512&height=512&nologo=true`;
                await validateImageUrl(fallbackUrl, 'nsfwai-fallback');
                
                return {
                    url: fallbackUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'nsfwai'
                };
            }
        }

        // DynaPictures API (Adult)
        async function generateWithDynaPictures(prompt, seed) {
            try {
                const response = await fetch('https://api.dynapictures.com/v1/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        prompt: prompt,
                        seed: seed,
                        adult_content: true,
                        quality: 'high'
                    })
                });

                if (!response.ok) {
                    throw new Error(`DynaPictures API error: ${response.status}`);
                }

                const data = await response.json();
                await validateImageUrl(data.image_url, 'dynapictures');
                
                return {
                    url: data.image_url,
                    prompt: prompt,
                    seed: seed,
                    provider: 'dynapictures'
                };
            } catch (error) {
                console.error('DynaPictures generation failed:', error);
                // Fallback to a working API
                const fallbackUrl = `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt)}?seed=${seed}&width=512&height=512&nologo=true`;
                await validateImageUrl(fallbackUrl, 'dynapictures-fallback');
                
                return {
                    url: fallbackUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'dynapictures'
                };
            }
        }

        // Gemini 2.0 Flash API (Uncensored)
        async function generateWithGemini(prompt, seed) {
            try {
                const response = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `Generate an image: ${prompt}`
                            }]
                        }],
                        generationConfig: {
                            seed: seed,
                            safetySettings: []
                        }
                    })
                });

                if (!response.ok) {
                    throw new Error(`Gemini API error: ${response.status}`);
                }

                const data = await response.json();
                const imageUrl = data.candidates[0].content.parts[0].inlineData?.data;
                
                if (imageUrl) {
                    const fullUrl = `data:image/png;base64,${imageUrl}`;
                    return {
                        url: fullUrl,
                        prompt: prompt,
                        seed: seed,
                        provider: 'gemini'
                    };
                } else {
                    throw new Error('No image data received from Gemini');
                }
            } catch (error) {
                console.error('Gemini generation failed:', error);
                // Fallback to a working API
                const fallbackUrl = `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt)}?seed=${seed}&width=512&height=512&nologo=true`;
                await validateImageUrl(fallbackUrl, 'gemini-fallback');
                
                return {
                    url: fallbackUrl,
                    prompt: prompt,
                    seed: seed,
                    provider: 'gemini'
                };
            }
        }

        // Enhance prompt with style and quality modifiers
        function enhancePrompt(prompt, style, quality) {
            let enhanced = prompt;

            // Add style modifiers
            if (style) {
                enhanced += `, ${style} style`;
            }

            // Add quality modifiers
            switch (quality) {
                case 'high':
                    enhanced += ', high quality, detailed';
                    break;
                case 'ultra':
                    enhanced += ', ultra high definition, 8K, highly detailed';
                    break;
                case 'masterpiece':
                    enhanced += ', masterpiece, ultra high definition, 8K, highly detailed, professional photography';
                    break;
            }

            return enhanced;
        }

        // Text-to-Speech generation with working APIs
        async function generateSpeech(text, voice, speed, language, provider) {
            setGenerating(true, 'tts');
            showTTSLoading();

            try {
                let audioData = null;
                let attempts = 0;
                const maxAttempts = 3;

                while (audioData === null && attempts < maxAttempts) {
                    try {
                        switch (provider) {
                            case 'browser':
                                audioData = await generateWithBrowserTTS(text, voice, speed, language);
                                break;
                            case 'elevenlabs':
                                audioData = await generateWithTTSMP3(text, voice, speed, language);
                                break;
                            case 'openai':
                                audioData = await generateWithTTSMaker(text, voice, speed, language);
                                break;
                            default:
                                audioData = await generateWithBrowserTTS(text, voice, speed, language);
                        }
                    } catch (error) {
                        console.error(`TTS attempt ${attempts + 1} failed:`, error);
                        attempts++;
                        if (attempts < maxAttempts) {
                            // Try different provider for retry
                            if (provider === 'browser') {
                                provider = 'elevenlabs';
                            } else if (provider === 'elevenlabs') {
                                provider = 'openai';
                            } else {
                                provider = 'browser';
                            }
                        }
                    }
                }

                if (audioData) {
                    updateTTSResults(audioData);
                } else {
                    showTTSError('Failed to generate speech. Please try again.');
                }

            } catch (error) {
                console.error('TTS generation error:', error);
                showTTSError('An error occurred while generating speech. Please try again.');
            } finally {
                setGenerating(false, 'tts');
            }
        }

        // Browser TTS with proper MP3 recording
        async function generateWithBrowserTTS(text, voice, speed, language) {
            return new Promise((resolve, reject) => {
                if (!('speechSynthesis' in window)) {
                    reject(new Error('Speech synthesis not supported'));
                    return;
                }

                // Stop any ongoing speech
                speechSynthesis.cancel();

                const utterance = new SpeechSynthesisUtterance(text);
                
                // Set speed
                switch (speed) {
                    case 'slow':
                        utterance.rate = 0.7;
                        break;
                    case 'normal':
                        utterance.rate = 1.0;
                        break;
                    case 'fast':
                        utterance.rate = 1.3;
                        break;
                    case 'very_fast':
                        utterance.rate = 1.6;
                        break;
                    default:
                        utterance.rate = 1.0;
                }

                utterance.pitch = 1;
                utterance.lang = language;

                // Try to find appropriate voice
                const voices = speechSynthesis.getVoices();
                let selectedVoice = null;

                if (voice === 'female') {
                    selectedVoice = voices.find(v => 
                        v.lang.startsWith(language.split('-')[0]) && 
                        (v.name.toLowerCase().includes('female') || 
                         v.name.toLowerCase().includes('woman') ||
                         v.name.toLowerCase().includes('zira') ||
                         v.name.toLowerCase().includes('hazel'))
                    );
                } else {
                    selectedVoice = voices.find(v => 
                        v.lang.startsWith(language.split('-')[0]) && 
                        (v.name.toLowerCase().includes('male') || 
                         v.name.toLowerCase().includes('man') ||
                         v.name.toLowerCase().includes('david') ||
                         v.name.toLowerCase().includes('mark'))
                    );
                }

                if (!selectedVoice) {
                    selectedVoice = voices.find(v => v.lang.startsWith(language.split('-')[0]));
                }

                if (!selectedVoice && voices.length > 0) {
                    selectedVoice = voices[0];
                }

                if (selectedVoice) {
                    utterance.voice = selectedVoice;
                }

                // Create audio recording
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const destination = audioContext.createMediaStreamDestination();
                    const mediaRecorder = new MediaRecorder(destination.stream, { mimeType: 'audio/webm' });
                    const chunks = [];

                    mediaRecorder.ondataavailable = (event) => {
                        if (event.data.size > 0) {
                            chunks.push(event.data);
                        }
                    };

                    mediaRecorder.onstop = () => {
                        const audioBlob = new Blob(chunks, { type: 'audio/mp3' });
                        const audioUrl = URL.createObjectURL(audioBlob);
                        
                        resolve({
                            type: 'browser',
                            text: text,
                            voice: voice,
                            speed: speed,
                            language: language,
                            audioUrl: audioUrl,
                            audioBlob: audioBlob,
                            canPlay: true
                        });
                    };

                    utterance.onstart = () => {
                        mediaRecorder.start();
                    };

                    utterance.onend = () => {
                        setTimeout(() => {
                            mediaRecorder.stop();
                        }, 500);
                    };

                    utterance.onerror = (error) => {
                        reject(error);
                    };

                    speechSynthesis.speak(utterance);
                } catch (error) {
                    // Fallback without recording
                    utterance.onstart = () => {
                        resolve({
                            type: 'browser',
                            text: text,
                            voice: voice,
                            speed: speed,
                            language: language,
                            audioUrl: null,
                            audioBlob: null,
                            canPlay: false
                        });
                    };

                    utterance.onerror = (error) => {
                        reject(error);
                    };

                    speechSynthesis.speak(utterance);
                }
            });
        }

        // TTSMP3.com API (Free, no registration) - Fixed version
        async function generateWithTTSMP3(text, voice, speed, language) {
            try {
                const voiceCode = voice === 'female' ? 'en-us-x-sfg#female_2-local' : 'en-us-x-sfg#male_1-local';
                
                const response = await fetch('https://ttsmp3.com/makemp3_new.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                        'Referer': 'https://ttsmp3.com/',
                        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                    },
                    body: new URLSearchParams({
                        'msg': text,
                        'lang': voiceCode,
                        'source': 'ttsmp3'
                    })
                });

                if (!response.ok) {
                    throw new Error(`TTSMP3 API error: ${response.status}`);
                }

                const data = await response.json();
                if (data.Error === 0 && data.URL) {
                    return {
                        type: 'ttsmp3',
                        text: text,
                        voice: voice,
                        speed: speed,
                        language: language,
                        audioUrl: data.URL, // Use direct URL instead of blob
                        audioBlob: null,
                        canPlay: true
                    };
                } else {
                    throw new Error('TTSMP3 generation failed');
                }
            } catch (error) {
                console.error('TTSMP3 generation failed:', error);
                throw error;
            }
        }

        // Narakeet API (Free, no registration)
        async function generateWithNarakeet(text, voice, speed, language) {
            try {
                const voiceCode = voice === 'female' ? 'linda' : 'john';
                
                const response = await fetch('https://www.narakeet.com/api/text-to-speech', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Referer': 'https://www.narakeet.com/',
                        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                    },
                    body: JSON.stringify({
                        text: text,
                        voice: voiceCode,
                        format: 'mp3',
                        speed: speed === 'slow' ? 0.7 : speed === 'fast' ? 1.3 : speed === 'very_fast' ? 1.6 : 1.0
                    })
                });

                if (!response.ok) {
                    throw new Error(`Narakeet API error: ${response.status}`);
                }

                const audioBlob = await response.blob();
                const audioUrl = URL.createObjectURL(audioBlob);
                
                return {
                    type: 'narakeet',
                    text: text,
                    voice: voice,
                    speed: speed,
                    language: language,
                    audioUrl: audioUrl,
                    audioBlob: audioBlob,
                    canPlay: true
                };
            } catch (error) {
                console.error('Narakeet generation failed:', error);
                throw error;
            }
        }

        // SpeechGen.io API (Free, no registration)
        async function generateWithSpeechGen(text, voice, speed, language) {
            try {
                const voiceId = voice === 'female' ? 'en-US-AriaNeural' : 'en-US-GuyNeural';
                
                const response = await fetch('https://speechgen.io/api/v1/tts', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Referer': 'https://speechgen.io/',
                        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                    },
                    body: JSON.stringify({
                        text: text,
                        voice: voiceId,
                        format: 'mp3',
                        speed: speed === 'slow' ? 0.7 : speed === 'fast' ? 1.3 : speed === 'very_fast' ? 1.6 : 1.0
                    })
                });

                if (!response.ok) {
                    throw new Error(`SpeechGen API error: ${response.status}`);
                }

                const data = await response.json();
                if (data.success && data.audio_url) {
                    return {
                        type: 'speechgen',
                        text: text,
                        voice: voice,
                        speed: speed,
                        language: language,
                        audioUrl: data.audio_url,
                        audioBlob: null,
                        canPlay: true
                    };
                } else {
                    throw new Error('SpeechGen generation failed');
                }
            } catch (error) {
                console.error('SpeechGen generation failed:', error);
                throw error;
            }
        }

        // Luvvoice API (Free, no registration)
        async function generateWithLuvvoice(text, voice, speed, language) {
            try {
                const voiceCode = voice === 'female' ? 'en-US-AriaNeural' : 'en-US-GuyNeural';
                
                const response = await fetch('https://luvvoice.com/api/tts', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Referer': 'https://luvvoice.com/',
                        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                    },
                    body: JSON.stringify({
                        text: text,
                        voice: voiceCode,
                        format: 'mp3',
                        speed: speed === 'slow' ? 0.7 : speed === 'fast' ? 1.3 : speed === 'very_fast' ? 1.6 : 1.0
                    })
                });

                if (!response.ok) {
                    throw new Error(`Luvvoice API error: ${response.status}`);
                }

                const audioBlob = await response.blob();
                const audioUrl = URL.createObjectURL(audioBlob);
                
                return {
                    type: 'luvvoice',
                    text: text,
                    voice: voice,
                    speed: speed,
                    language: language,
                    audioUrl: audioUrl,
                    audioBlob: audioBlob,
                    canPlay: true
                };
            } catch (error) {
                console.error('Luvvoice generation failed:', error);
                throw error;
            }
        }

        // TTSMaker API (Free, no registration) - Fixed version
        async function generateWithTTSMaker(text, voice, speed, language) {
            try {
                const voiceId = voice === 'female' ? 'en-US-AriaNeural' : 'en-US-GuyNeural';
                
                const response = await fetch('https://ttsmaker.com/api/v1/create-tts-order', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Referer': 'https://ttsmaker.com/',
                        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                    },
                    body: JSON.stringify({
                        text: text,
                        voice_id: voiceId,
                        audio_format: 'mp3',
                        paragraph_pause: 300,
                        reading_speed: speed === 'slow' ? 0.7 : speed === 'fast' ? 1.3 : speed === 'very_fast' ? 1.6 : 1.0
                    })
                });

                if (!response.ok) {
                    throw new Error(`TTSMaker API error: ${response.status}`);
                }

                const data = await response.json();
                if (data.success && data.result_url) {
                    return {
                        type: 'ttsmaker',
                        text: text,
                        voice: voice,
                        speed: speed,
                        language: language,
                        audioUrl: data.result_url, // Use direct URL
                        audioBlob: null,
                        canPlay: true
                    };
                } else {
                    throw new Error('TTSMaker generation failed');
                }
            } catch (error) {
                console.error('TTSMaker generation failed:', error);
                throw error;
            }
        }

        // ElevenLabs TTS (Free tier with fallback) - Updated with new APIs
        async function generateWithElevenLabs(text, voice, speed) {
            try {
                // Try Narakeet first
                return await generateWithNarakeet(text, voice, speed, 'en-us');
            } catch (error) {
                try {
                    // Try SpeechGen as fallback
                    return await generateWithSpeechGen(text, voice, speed, 'en-us');
                } catch (error2) {
                    // Final fallback to browser TTS
                    return await generateWithBrowserTTS(text, voice, speed, 'en-US');
                }
            }
        }

        // OpenAI TTS (Free alternative with fallback) - Updated with new APIs
        async function generateWithOpenAITTS(text, voice, speed) {
            try {
                // Try Luvvoice first
                return await generateWithLuvvoice(text, voice, speed, 'en-us');
            } catch (error) {
                try {
                    // Try TTSMaker as fallback
                    return await generateWithTTSMaker(text, voice, speed, 'en-us');
                } catch (error2) {
                    // Final fallback to browser TTS
                    return await generateWithBrowserTTS(text, voice, speed, 'en-US');
                }
            }
        }

        // Set generating state
        function setGenerating(generating, type = 'image') {
            isGenerating = generating;
            const btnId = type === 'image' ? 'generateBtn' : 'ttsGenerateBtn';
            const btn = document.getElementById(btnId);
            
            if (generating) {
                btn.disabled = true;
                if (type === 'image') {
                    btn.innerHTML = '<span class="btn-icon">‚è≥</span>Generating...';
                } else {
                    btn.innerHTML = '<span class="btn-icon">‚è≥</span>Generating Speech...';
                }
            } else {
                btn.disabled = false;
                if (type === 'image') {
                    btn.innerHTML = '<span class="btn-icon">üöÄ</span>Generate Masterpiece';
                } else {
                    btn.innerHTML = '<span class="btn-icon">üéµ</span>Generate Speech';
                }
            }
        }

        // Show loading state for images
        function showLoading() {
            const container = document.getElementById('resultsContainer');
            container.innerHTML = `
                <div class="loading-container">
                    <div class="loading-spinner"></div>
                    <div class="loading-text">Creating Your Masterpiece...</div>
                    <div class="loading-subtext">LND AI is processing your request</div>
                </div>
            `;
        }

        // Show loading state for TTS
        function showTTSLoading() {
            const container = document.getElementById('ttsResultsContainer');
            container.innerHTML = `
                <div class="loading-container">
                    <div class="loading-spinner"></div>
                    <div class="loading-text">Generating Speech...</div>
                    <div class="loading-subtext">Converting your text to natural speech</div>
                </div>
            `;
        }

        // Show error message for images
        function showError(message, showReload = false) {
            const container = document.getElementById('resultsContainer');
            container.innerHTML = `
                <div class="empty-state">
                    <div class="empty-icon">‚ö†Ô∏è</div>
                    <div class="empty-text">Generation Failed</div>
                    <div class="empty-subtext">${message}</div>
                </div>
                <div class="error-message">
                    <span>‚ùå</span>
                    <span>${message}</span>
                </div>
                ${showReload ? '<button class="reload-btn" onclick="window.location.reload()">Reload Page</button>' : ''}
            `;
        }

        // Show error message for TTS
        function showTTSError(message) {
            const container = document.getElementById('ttsResultsContainer');
            container.innerHTML = `
                <div class="empty-state">
                    <div class="empty-icon">‚ö†Ô∏è</div>
                    <div class="empty-text">Speech Generation Failed</div>
                    <div class="empty-subtext">${message}</div>
                </div>
                <div class="error-message">
                    <span>‚ùå</span>
                    <span>${message}</span>
                </div>
            `;
        }

        // Update results display for images
        function updateResults(images) {
            const container = document.getElementById('resultsContainer');
            const countElement = document.getElementById('resultsCount');
            
            countElement.textContent = `${images.length} Image${images.length !== 1 ? 's' : ''}`;
            
            if (images.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üé®</div>
                        <div class="empty-text">Ready to Create Magic</div>
                        <div class="empty-subtext">Enter your prompt above and let LND AI bring your imagination to life</div>
                    </div>
                `;
                return;
            }

            const imageGrid = document.createElement('div');
            imageGrid.className = 'image-grid';

            images.forEach((image, index) => {
                const imageCard = createImageCard(image, index);
                imageGrid.appendChild(imageCard);
            });

            container.innerHTML = '';
            container.appendChild(imageGrid);
        }

        // Update results display for TTS
        function updateTTSResults(audioData) {
            const container = document.getElementById('ttsResultsContainer');
            const countElement = document.getElementById('ttsResultsCount');
            
            countElement.textContent = '1 Audio';
            
            container.innerHTML = `
                <div class="results-section" style="background: rgba(0, 0, 0, 0.3); border-radius: 15px; padding: 25px; margin-top: 20px;">
                    <div class="audio-card">
                        <div class="audio-info">
                            <h4 style="color: var(--text-light); margin-bottom: 10px;">Generated Speech</h4>
                            <p style="color: var(--text-muted); margin-bottom: 15px;">${truncateText(audioData.text, 100)}</p>
                            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                                ${audioData.canPlay ? `
                                    <button class="download-btn" onclick="playTTSAudio('${audioData.audioUrl}')">
                                        ‚ñ∂Ô∏è Play Audio
                                    </button>
                                ` : `
                                    <button class="download-btn" onclick="playTTS('${audioData.text}', '${audioData.voice}', ${audioData.speed}, '${audioData.language}')">
                                        ‚ñ∂Ô∏è Play Audio
                                    </button>
                                `}
                                <button class="download-btn" onclick="downloadTTSAudio('${audioData.audioUrl}', '${audioData.text}')">
                                    ‚¨áÔ∏è Download MP3
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Play TTS audio from URL
        function playTTSAudio(audioUrl) {
            const audio = new Audio(audioUrl);
            audio.play().catch(error => {
                console.error('Error playing audio:', error);
                alert('Error playing audio. Please try downloading instead.');
            });
        }

        // Download TTS audio as MP3
        function downloadTTSAudio(audioUrl, text) {
            const link = document.createElement('a');
            link.href = audioUrl;
            link.download = `lnd-tts-${text.substring(0, 30).replace(/[^a-zA-Z0-9]/g, '_')}-${Date.now()}.mp3`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        function playTTS(text, voice, speed, language) {
            if ('speechSynthesis' in window) {
                // Stop any ongoing speech
                speechSynthesis.cancel();
                
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = speed;
                utterance.pitch = 1;
                utterance.lang = language;
                
                // Try to find appropriate voice
                const voices = speechSynthesis.getVoices();
                const selectedVoice = voices.find(v => 
                    voice === 'female' ? 
                    v.name.toLowerCase().includes('female') || v.name.toLowerCase().includes('woman') :
                    v.name.toLowerCase().includes('male') || v.name.toLowerCase().includes('man')
                ) || voices[0];
                
                if (selectedVoice) {
                    utterance.voice = selectedVoice;
                }
                
                speechSynthesis.speak(utterance);
            } else {
                alert('Text-to-speech is not supported in your browser.');
            }
        }

        // Download TTS audio as MP3 - Fixed version
        function downloadTTSAudio(audioUrl, text) {
            if (audioUrl && audioUrl !== 'null') {
                // Create a temporary anchor element for download
                const link = document.createElement('a');
                link.href = audioUrl;
                link.download = `lnd-tts-${text.substring(0, 30).replace(/[^a-zA-Z0-9]/g, '_')}-${Date.now()}.mp3`;
                link.style.display = 'none';
                
                // Add to DOM, click, and remove
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else {
                alert('Audio not available for download. Please try generating speech again.');
            }
        }

        // Download TTS audio (simplified version using browser TTS)
        function downloadTTS(text, voice, speed, language) {
            // For browser TTS, we can't directly record the audio
            // So we'll create a simple text file with the speech parameters
            const audioInfo = {
                text: text,
                voice: voice,
                speed: speed,
                language: language,
                timestamp: new Date().toISOString(),
                note: "This is a text file with speech parameters. Use the Play Audio button to hear the speech."
            };
            
            const blob = new Blob([JSON.stringify(audioInfo, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `lnd-tts-${Date.now()}.json`;
            link.style.display = 'none';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            URL.revokeObjectURL(url);
            
            // Also play the audio immediately
            playTTS(text, voice, speed, language);
        }

        // Create image card element
        function createImageCard(image, index) {
            const card = document.createElement('div');
            card.className = 'image-card fade-in';
            card.style.animationDelay = `${index * 0.1}s`;

            card.innerHTML = `
                <div class="image-container">
                    <img 
                        src="${image.url}" 
                        alt="${image.prompt}" 
                        class="generated-image" 
                        loading="lazy"
                        onerror="this.parentElement.parentElement.style.display='none'"
                    />
                    <div class="image-overlay">
                        <button class="download-btn" onclick="downloadImage('${image.url}', 'lnd-ai-generated-${image.seed}')">
                            ‚¨áÔ∏è Download
                        </button>
                    </div>
                </div>
                <div class="image-info">
                    <div class="image-source">LND AI ‚Ä¢ ${getProviderName(image.provider)}</div>
                    <div class="image-prompt">${truncateText(image.prompt, 100)}</div>
                    <button class="download-btn" onclick="downloadImage('${image.url}', 'lnd-ai-generated-${image.seed}')">
                        ‚¨áÔ∏è Download HD
                    </button>
                </div>
            `;

            return card;
        }

        // Download image function
        async function downloadImage(url, filename) {
            try {
                // Fetch the image as a blob
                const response = await fetch(url);
                if (!response.ok) throw new Error('Failed to fetch image');
                
                const blob = await response.blob();
                
                // Create a temporary URL for the blob
                const blobUrl = window.URL.createObjectURL(blob);
                
                // Create download link
                const link = document.createElement('a');
                link.href = blobUrl;
                link.download = `${filename}.jpg`;
                link.style.display = 'none';
                
                // Add to DOM, click, and remove
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Clean up the blob URL
                window.URL.revokeObjectURL(blobUrl);
                
            } catch (error) {
                console.error('Download failed:', error);
                try {
                    // Fallback: try direct download
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = `${filename}.jpg`;
                    link.target = '_blank';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                } catch (fallbackError) {
                    console.error('Fallback download failed:', fallbackError);
                    // Last resort: open in new tab
                    window.open(url, '_blank');
                }
            }
        }

        // Get provider display name
        function getProviderName(provider) {
            const names = {
                'pollinations': 'Pollinations Engine',
                'deepai': 'DeepAI Engine',
                'huggingface': 'HuggingFace Engine',
                'modelslab': 'ModelsLab (Uncensored)',
                'replicate': 'Replicate Engine'
            };
            return names[provider] || 'LND AI Engine';
        }

        // Truncate text to specified length
        function truncateText(text, maxLength) {
            if (text.length <= maxLength) return text;
            return text.substring(0, maxLength) + '...';
        }

        // Hash function for generating seeds
        function hashCode(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash; // Convert to 32bit integer
            }
            return Math.abs(hash);
        }

        // Additional Tools Functions

        // Image Resize Tool
        function resizeImage() {
            const fileInput = document.getElementById('resizeImageInput');
            const width = parseInt(document.getElementById('resizeWidth').value);
            const height = parseInt(document.getElementById('resizeHeight').value);
            const resultDiv = document.getElementById('resizeResult');
            
            if (!fileInput.files[0]) {
                resultDiv.innerHTML = '<div class="error-message"><span>‚ùå</span><span>Please select an image file.</span></div>';
                return;
            }
            
            if (!width || !height) {
                resultDiv.innerHTML = '<div class="error-message"><span>‚ùå</span><span>Please enter valid width and height values.</span></div>';
                return;
            }
            
            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    
                    canvas.width = width;
                    canvas.height = height;
                    
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    canvas.toBlob(function(blob) {
                        const url = URL.createObjectURL(blob);
                        resultDiv.innerHTML = `
                            <div class="results-section" style="background: rgba(0, 0, 0, 0.3); border-radius: 15px; padding: 25px; margin-top: 20px;">
                                <h4 style="color: var(--text-light); margin-bottom: 15px;">Resized Image (${width}x${height})</h4>
                                <img src="${url}" style="max-width: 100%; border-radius: 10px; margin-bottom: 15px;" alt="Resized image">
                                <button class="download-btn" onclick="downloadBlob('${url}', 'lnd-resized-${width}x${height}-${Date.now()}.jpg')">
                                    ‚¨áÔ∏è Download Resized Image
                                </button>
                            </div>
                        `;
                    }, 'image/jpeg', 0.9);
                };
                img.src = e.target.result;
            };
            
            reader.readAsDataURL(file);
        }

        // Image Format Converter
        function convertImage() {
            const fileInput = document.getElementById('convertImageInput');
            const format = document.getElementById('convertFormat').value;
            const resultDiv = document.getElementById('convertResult');
            
            if (!fileInput.files[0]) {
                resultDiv.innerHTML = '<div class="error-message"><span>‚ùå</span><span>Please select an image file.</span></div>';
                return;
            }
            
            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    
                    canvas.width = img.width;
                    canvas.height = img.height;
                    
                    ctx.drawImage(img, 0, 0);
                    
                    const mimeType = format === 'jpeg' ? 'image/jpeg' : format === 'png' ? 'image/png' : 'image/webp';
                    const extension = format === 'jpeg' ? 'jpg' : format;
                    
                    canvas.toBlob(function(blob) {
                        const url = URL.createObjectURL(blob);
                        resultDiv.innerHTML = `
                            <div class="results-section" style="background: rgba(0, 0, 0, 0.3); border-radius: 15px; padding: 25px; margin-top: 20px;">
                                <h4 style="color: var(--text-light); margin-bottom: 15px;">Converted to ${format.toUpperCase()}</h4>
                                <img src="${url}" style="max-width: 100%; border-radius: 10px; margin-bottom: 15px;" alt="Converted image">
                                <button class="download-btn" onclick="downloadBlob('${url}', 'lnd-converted-${Date.now()}.${extension}')">
                                    ‚¨áÔ∏è Download ${format.toUpperCase()} Image
                                </button>
                            </div>
                        `;
                    }, mimeType, 0.9);
                };
                img.src = e.target.result;
            };
            
            reader.readAsDataURL(file);
        }

        // QR Code Generator
        function generateQR() {
            const text = document.getElementById('qrText').value.trim();
            const size = document.getElementById('qrSize').value;
            const resultDiv = document.getElementById('qrResult');
            
            if (!text) {
                resultDiv.innerHTML = '<div class="error-message"><span>‚ùå</span><span>Please enter text or URL to generate QR code.</span></div>';
                return;
            }
            
            // Using QR Server API (free)
            const encodedText = encodeURIComponent(text);
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=${size}x${size}&data=${encodedText}`;
            
            resultDiv.innerHTML = `
                <div class="results-section" style="background: rgba(0, 0, 0, 0.3); border-radius: 15px; padding: 25px; margin-top: 20px;">
                    <h4 style="color: var(--text-light); margin-bottom: 15px;">Generated QR Code</h4>
                    <div style="text-align: center; margin-bottom: 15px;">
                        <img src="${qrUrl}" style="border-radius: 10px; background: white; padding: 10px;" alt="QR Code">
                    </div>
                    <p style="color: var(--text-muted); margin-bottom: 15px; word-break: break-all;">${text}</p>
                    <button class="download-btn" onclick="downloadImage('${qrUrl}', 'lnd-qrcode-${Date.now()}')">
                        ‚¨áÔ∏è Download QR Code
                    </button>
                </div>
            `;
        }

        // Weather Check
        async function getWeather() {
            const city = document.getElementById('cityName').value.trim();
            const resultDiv = document.getElementById('weatherResult');
            
            if (!city) {
                resultDiv.innerHTML = '<div class="error-message"><span>‚ùå</span><span>Please enter a city name.</span></div>';
                return;
            }
            
            try {
                // Using OpenWeatherMap API (free tier)
                // Note: In production, you'd want to use your own API key
                const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=demo&units=metric`);
                
                if (!response.ok) {
                    // Fallback to a mock weather service for demo
                    const mockWeather = {
                        name: city,
                        main: {
                            temp: Math.floor(Math.random() * 30) + 5,
                            feels_like: Math.floor(Math.random() * 30) + 5,
                            humidity: Math.floor(Math.random() * 50) + 30
                        },
                        weather: [{
                            main: ['Sunny', 'Cloudy', 'Rainy', 'Snowy'][Math.floor(Math.random() * 4)],
                            description: 'pleasant weather'
                        }],
                        wind: {
                            speed: Math.floor(Math.random() * 10) + 2
                        }
                    };
                    
                    displayWeather(mockWeather, resultDiv);
                    return;
                }
                
                const data = await response.json();
                displayWeather(data, resultDiv);
                
            } catch (error) {
                console.error('Weather fetch failed:', error);
                resultDiv.innerHTML = '<div class="error-message"><span>‚ùå</span><span>Failed to fetch weather data. Please try again.</span></div>';
            }
        }

        function displayWeather(data, resultDiv) {
            const weatherIcon = getWeatherIcon(data.weather[0].main);
            
            resultDiv.innerHTML = `
                <div class="results-section" style="background: rgba(0, 0, 0, 0.3); border-radius: 15px; padding: 25px; margin-top: 20px;">
                    <h4 style="color: var(--text-light); margin-bottom: 15px;">${weatherIcon} Weather in ${data.name}</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--accent-purple);">${Math.round(data.main.temp)}¬∞C</div>
                            <div style="color: var(--text-muted);">Temperature</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.5rem; color: var(--light-purple);">${data.main.humidity}%</div>
                            <div style="color: var(--text-muted);">Humidity</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.5rem; color: var(--text-accent);">${data.wind.speed} m/s</div>
                            <div style="color: var(--text-muted);">Wind Speed</div>
                        </div>
                    </div>
                    <div style="margin-top: 15px; text-align: center;">
                        <div style="color: var(--text-light); font-weight: 600;">${data.weather[0].main}</div>
                        <div style="color: var(--text-muted); text-transform: capitalize;">${data.weather[0].description}</div>
                    </div>
                </div>
            `;
        }

        function getWeatherIcon(weather) {
            const icons = {
                'Sunny': '‚òÄÔ∏è',
                'Clear': '‚òÄÔ∏è',
                'Cloudy': '‚òÅÔ∏è',
                'Clouds': '‚òÅÔ∏è',
                'Rainy': 'üåßÔ∏è',
                'Rain': 'üåßÔ∏è',
                'Snowy': '‚ùÑÔ∏è',
                'Snow': '‚ùÑÔ∏è',
                'Thunderstorm': '‚õàÔ∏è'
            };
            return icons[weather] || 'üå§Ô∏è';
        }

        // IP Detector
        async function getIPInfo() {
            const ipInput = document.getElementById('ipAddress').value.trim();
            const resultDiv = document.getElementById('ipResult');
            
            try {
                let url = 'https://ipapi.co/json/';
                if (ipInput) {
                    url = `https://ipapi.co/${ipInput}/json/`;
                }
                
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error('Failed to fetch IP information');
                }
                
                const data = await response.json();
                
                resultDiv.innerHTML = `
                    <div class="results-section" style="background: rgba(0, 0, 0, 0.3); border-radius: 15px; padding: 25px; margin-top: 20px;">
                        <h4 style="color: var(--text-light); margin-bottom: 15px;">üåê IP Information</h4>
                        <div style="display: grid; gap: 10px;">
                            <div><strong style="color: var(--accent-purple);">IP Address:</strong> <span style="color: var(--text-light);">${data.ip}</span></div>
                            <div><strong style="color: var(--accent-purple);">Location:</strong> <span style="color: var(--text-light);">${data.city}, ${data.region}, ${data.country_name}</span></div>
                            <div><strong style="color: var(--accent-purple);">ISP:</strong> <span style="color: var(--text-light);">${data.org}</span></div>
                            <div><strong style="color: var(--accent-purple);">Timezone:</strong> <span style="color: var(--text-light);">${data.timezone}</span></div>
                            ${data.latitude ? `<div><strong style="color: var(--accent-purple);">Coordinates:</strong> <span style="color: var(--text-light);">${data.latitude}, ${data.longitude}</span></div>` : ''}
                        </div>
                    </div>
                `;
                
            } catch (error) {
                console.error('IP info fetch failed:', error);
                resultDiv.innerHTML = '<div class="error-message"><span>‚ùå</span><span>Failed to fetch IP information. Please try again.</span></div>';
            }
        }

        // Random Image Generator
        function generateRandomImage() {
            const category = document.getElementById('randomCategory').value;
            const size = document.getElementById('randomSize').value;
            const resultDiv = document.getElementById('randomResult');
            
            // Using Lorem Picsum for random images
            const [width, height] = size.split('x');
            let imageUrl = `https://picsum.photos/${width}/${height}`;
            
            if (category) {
                // Add category as a seed for consistency
                const seed = hashCode(category + Date.now());
                imageUrl += `?random=${seed}`;
            } else {
                imageUrl += `?random=${Date.now()}`;
            }
            
            resultDiv.innerHTML = `
                <div class="results-section" style="background: rgba(0, 0, 0, 0.3); border-radius: 15px; padding: 25px; margin-top: 20px;">
                    <h4 style="color: var(--text-light); margin-bottom: 15px;">üé≤ Random Image${category ? ` (${category})` : ''}</h4>
                    <div style="text-align: center; margin-bottom: 15px;">
                        <img src="${imageUrl}" style="max-width: 100%; border-radius: 10px;" alt="Random image" onload="this.style.opacity=1" style="opacity:0; transition: opacity 0.3s;">
                    </div>
                    <div style="text-align: center;">
                        <button class="download-btn" onclick="downloadImage('${imageUrl}', 'lnd-random-${Date.now()}')">
                            ‚¨áÔ∏è Download Image
                        </button>
                        <button class="download-btn" onclick="generateRandomImage()" style="margin-left: 10px;">
                            üé≤ Generate New
                        </button>
                    </div>
                </div>
            `;
        }

        // Download blob function
        function downloadBlob(url, filename) {
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            link.style.display = 'none';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Calculator Functions
        let calculatorHistory = [];
        let currentExpression = '';

        function appendToDisplay(value) {
            const display = document.getElementById('calcDisplay');
            if (display.value === '0' || display.value === 'Error') {
                display.value = '';
            }
            display.value += value;
            currentExpression = display.value;
        }

        function appendFunction(func) {
            const display = document.getElementById('calcDisplay');
            if (display.value === '0' || display.value === 'Error') {
                display.value = '';
            }
            display.value += func;
            currentExpression = display.value;
        }

        function clearCalculator() {
            document.getElementById('calcDisplay').value = '0';
            currentExpression = '';
        }

        function deleteLast() {
            const display = document.getElementById('calcDisplay');
            if (display.value.length > 1) {
                display.value = display.value.slice(0, -1);
            } else {
                display.value = '0';
            }
            currentExpression = display.value;
        }

        function calculateResult() {
            const display = document.getElementById('calcDisplay');
            const expression = display.value;
            
            try {
                // Replace display symbols with JavaScript operators
                let jsExpression = expression
                    .replace(/√ó/g, '*')
                    .replace(/√∑/g, '/')
                    .replace(/‚àí/g, '-')
                    .replace(/œÄ/g, 'Math.PI')
                    .replace(/e/g, 'Math.E');
                
                // Evaluate the expression safely
                const result = Function('"use strict"; return (' + jsExpression + ')')();
                
                if (isNaN(result) || !isFinite(result)) {
                    throw new Error('Invalid calculation');
                }
                
                // Add to history
                addToHistory(expression, result);
                
                // Display result
                display.value = result.toString();
                currentExpression = result.toString();
                
            } catch (error) {
                display.value = 'Error';
                currentExpression = '';
            }
        }

        function addToHistory(expression, result) {
            calculatorHistory.unshift({ expression, result });
            if (calculatorHistory.length > 10) {
                calculatorHistory.pop();
            }
            updateHistoryDisplay();
        }

        function updateHistoryDisplay() {
            const historyDiv = document.getElementById('calcHistory');
            if (calculatorHistory.length === 0) {
                historyDiv.innerHTML = '<div style="color: var(--text-muted); text-align: center;">No calculations yet</div>';
                return;
            }
            
            historyDiv.innerHTML = calculatorHistory.map(item => `
                <div class="history-item">
                    <span class="history-expression">${item.expression}</span>
                    <span class="history-result">= ${item.result}</span>
                </div>
            `).join('');
        }

        // Initialize calculator display
        document.addEventListener('DOMContentLoaded', function() {
            if (document.getElementById('calcDisplay')) {
                document.getElementById('calcDisplay').value = '0';
                updateHistoryDisplay();
            }
        });

        // Hash Converter Functions
        async function generateHash() {
            const input = document.getElementById('hashInput').value.trim();
            const algorithm = document.getElementById('hashAlgorithm').value;
            const salt = document.getElementById('hashSalt').value.trim();
            const resultDiv = document.getElementById('hashResult');
            
            if (!input) {
                resultDiv.innerHTML = '<div class="error-message"><span>‚ùå</span><span>Please enter text to hash.</span></div>';
                return;
            }
            
            try {
                let hash = '';
                let saltedInput = salt ? salt + input : input;
                
                switch (algorithm) {
                    case 'md5':
                        hash = await generateMD5(saltedInput);
                        break;
                    case 'sha1':
                        hash = await generateSHA1(saltedInput);
                        break;
                    case 'sha256':
                        hash = await generateSHA256(saltedInput);
                        break;
                    case 'sha512':
                        hash = await generateSHA512(saltedInput);
                        break;
                    case 'bcrypt':
                        hash = await generateBcrypt(input, salt || generateRandomSaltString());
                        break;
                    case 'pbkdf2':
                        hash = await generatePBKDF2(input, salt || generateRandomSaltString());
                        break;
                    default:
                        hash = await generateSHA256(saltedInput);
                }
                
                resultDiv.innerHTML = `
                    <div class="results-section" style="background: rgba(0, 0, 0, 0.3); border-radius: 15px; padding: 25px; margin-top: 20px;">
                        <h4 style="color: var(--text-light); margin-bottom: 15px;">üîê Hash Result</h4>
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <strong style="color: var(--accent-purple);">Algorithm:</strong> 
                                <span style="color: var(--text-light);">${algorithm.toUpperCase()}</span>
                            </div>
                            ${salt ? `<div><strong style="color: var(--accent-purple);">Salt:</strong> <span style="color: var(--text-light); font-family: 'Courier New', monospace;">${salt}</span></div>` : ''}
                            <div>
                                <strong style="color: var(--accent-purple);">Hash:</strong>
                                <div style="background: rgba(0, 0, 0, 0.5); padding: 15px; border-radius: 8px; margin-top: 10px; word-break: break-all; font-family: 'Courier New', monospace; color: var(--text-light);">
                                    ${hash}
                                </div>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 20px;">
                            <button class="download-btn" onclick="copyToClipboard('${hash}')">
                                üìã Copy Hash
                            </button>
                            <button class="download-btn" onclick="downloadHash('${hash}', '${algorithm}')" style="margin-left: 10px;">
                                ‚¨áÔ∏è Download
                            </button>
                        </div>
                    </div>
                `;
                
            } catch (error) {
                console.error('Hash generation failed:', error);
                resultDiv.innerHTML = '<div class="error-message"><span>‚ùå</span><span>Failed to generate hash. Please try again.</span></div>';
            }
        }

        function generateRandomSalt() {
            const salt = generateRandomSaltString();
            document.getElementById('hashSalt').value = salt;
        }

        function generateRandomSaltString() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*';
            let salt = '';
            for (let i = 0; i < 16; i++) {
                salt += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return salt;
        }

        // Hash generation functions using Web Crypto API
        async function generateMD5(input) {
            // MD5 is not available in Web Crypto API, using a simple hash simulation
            return await simpleHash(input, 'MD5');
        }

        async function generateSHA1(input) {
            const encoder = new TextEncoder();
            const data = encoder.encode(input);
            const hashBuffer = await crypto.subtle.digest('SHA-1', data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        async function generateSHA256(input) {
            const encoder = new TextEncoder();
            const data = encoder.encode(input);
            const hashBuffer = await crypto.subtle.digest('SHA-256', data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        async function generateSHA512(input) {
            const encoder = new TextEncoder();
            const data = encoder.encode(input);
            const hashBuffer = await crypto.subtle.digest('SHA-512', data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        async function generateBcrypt(input, salt) {
            // Bcrypt simulation using PBKDF2
            return await generatePBKDF2(input, salt, 10000);
        }

        async function generatePBKDF2(input, salt, iterations = 100000) {
            const encoder = new TextEncoder();
            const keyMaterial = await crypto.subtle.importKey(
                'raw',
                encoder.encode(input),
                { name: 'PBKDF2' },
                false,
                ['deriveBits']
            );
            
            const derivedBits = await crypto.subtle.deriveBits(
                {
                    name: 'PBKDF2',
                    salt: encoder.encode(salt),
                    iterations: iterations,
                    hash: 'SHA-256'
                },
                keyMaterial,
                256
            );
            
            const hashArray = Array.from(new Uint8Array(derivedBits));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        async function simpleHash(input, algorithm) {
            // Simple hash for algorithms not available in Web Crypto API
            let hash = 0;
            for (let i = 0; i < input.length; i++) {
                const char = input.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash; // Convert to 32-bit integer
            }
            
            // Convert to hex and pad
            let hexHash = Math.abs(hash).toString(16);
            while (hexHash.length < 32) {
                hexHash = '0' + hexHash;
            }
            
            return hexHash;
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                // Show temporary success message
                const btn = event.target;
                const originalText = btn.innerHTML;
                btn.innerHTML = '‚úÖ Copied!';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy: ', err);
            });
        }

        function downloadHash(hash, algorithm) {
            const content = `Hash Algorithm: ${algorithm.toUpperCase()}\nHash: ${hash}\nGenerated: ${new Date().toISOString()}`;
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            downloadBlob(url, `lnd-hash-${algorithm}-${Date.now()}.txt`);
            URL.revokeObjectURL(url);
        }

        // Binary Converter Functions
        function convertBinary() {
            const input = document.getElementById('binaryInput').value.trim();
            const inputFormat = document.getElementById('inputFormat').value;
            const outputFormat = document.getElementById('outputFormat').value;
            const resultDiv = document.getElementById('binaryResult');
            
            if (!input) {
                resultDiv.innerHTML = '<div class="error-message"><span>‚ùå</span><span>Please enter a value to convert.</span></div>';
                return;
            }
            
            try {
                let result = '';
                let decimal = 0;
                
                // Convert input to decimal first
                switch (inputFormat) {
                    case 'decimal':
                        decimal = parseInt(input, 10);
                        if (isNaN(decimal)) throw new Error('Invalid decimal number');
                        break;
                    case 'binary':
                        if (!/^[01\s]+$/.test(input.replace(/\s/g, ''))) throw new Error('Invalid binary number');
                        decimal = parseInt(input.replace(/\s/g, ''), 2);
                        break;
                    case 'octal':
                        if (!/^[0-7\s]+$/.test(input.replace(/\s/g, ''))) throw new Error('Invalid octal number');
                        decimal = parseInt(input.replace(/\s/g, ''), 8);
                        break;
                    case 'hexadecimal':
                        if (!/^[0-9A-Fa-f\s]+$/.test(input.replace(/\s/g, ''))) throw new Error('Invalid hexadecimal number');
                        decimal = parseInt(input.replace(/\s/g, ''), 16);
                        break;
                    case 'text':
                        // Convert text to binary representation
                        result = convertTextToBinary(input, outputFormat);
                        break;
                }
                
                // Convert decimal to output format (if not text input)
                if (inputFormat !== 'text') {
                    switch (outputFormat) {
                        case 'decimal':
                            result = decimal.toString(10);
                            break;
                        case 'binary':
                            result = decimal.toString(2);
                            break;
                        case 'octal':
                            result = decimal.toString(8);
                            break;
                        case 'hexadecimal':
                            result = decimal.toString(16).toUpperCase();
                            break;
                        case 'text':
                            result = convertDecimalToText(decimal);
                            break;
                    }
                }
                
                // Format result for better readability
                let formattedResult = result;
                if (outputFormat === 'binary' && result.length > 8) {
                    formattedResult = result.replace(/(.{8})/g, '$1 ').trim();
                } else if (outputFormat === 'hexadecimal' && result.length > 2) {
                    formattedResult = result.replace(/(.{2})/g, '$1 ').trim();
                }
                
                resultDiv.innerHTML = `
                    <div class="results-section" style="background: rgba(0, 0, 0, 0.3); border-radius: 15px; padding: 25px; margin-top: 20px;">
                        <h4 style="color: var(--text-light); margin-bottom: 15px;">üíª Conversion Result</h4>
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <strong style="color: var(--accent-purple);">Input:</strong> 
                                <span style="color: var(--text-light);">${input} (${inputFormat})</span>
                            </div>
                            <div>
                                <strong style="color: var(--accent-purple);">Output:</strong>
                                <div style="background: rgba(0, 0, 0, 0.5); padding: 15px; border-radius: 8px; margin-top: 10px; word-break: break-all; font-family: 'Courier New', monospace; color: var(--text-light);">
                                    ${formattedResult}
                                </div>
                                <div style="font-size: 0.9rem; color: var(--text-muted); margin-top: 5px;">
                                    Format: ${outputFormat.charAt(0).toUpperCase() + outputFormat.slice(1)}
                                </div>
                            </div>
                            ${inputFormat !== 'text' && outputFormat !== 'text' ? `
                                <div>
                                    <strong style="color: var(--accent-purple);">Decimal Value:</strong> 
                                    <span style="color: var(--text-light);">${decimal}</span>
                                </div>
                            ` : ''}
                        </div>
                        <div style="text-align: center; margin-top: 20px;">
                            <button class="download-btn" onclick="copyToClipboard('${result}')">
                                üìã Copy Result
                            </button>
                            <button class="download-btn" onclick="downloadBinaryResult('${input}', '${inputFormat}', '${result}', '${outputFormat}')" style="margin-left: 10px;">
                                ‚¨áÔ∏è Download
                            </button>
                        </div>
                    </div>
                `;
                
            } catch (error) {
                console.error('Binary conversion failed:', error);
                resultDiv.innerHTML = `<div class="error-message"><span>‚ùå</span><span>Conversion failed: ${error.message}</span></div>`;
            }
        }

        function convertTextToBinary(text, outputFormat) {
            let result = '';
            
            for (let i = 0; i < text.length; i++) {
                const charCode = text.charCodeAt(i);
                
                switch (outputFormat) {
                    case 'binary':
                        result += charCode.toString(2).padStart(8, '0') + ' ';
                        break;
                    case 'decimal':
                        result += charCode.toString(10) + ' ';
                        break;
                    case 'octal':
                        result += charCode.toString(8) + ' ';
                        break;
                    case 'hexadecimal':
                        result += charCode.toString(16).toUpperCase() + ' ';
                        break;
                    default:
                        result += charCode.toString(2).padStart(8, '0') + ' ';
                }
            }
            
            return result.trim();
        }

        function convertDecimalToText(decimal) {
            try {
                return String.fromCharCode(decimal);
            } catch (error) {
                throw new Error('Cannot convert to valid ASCII character');
            }
        }

        function clearBinaryConverter() {
            document.getElementById('binaryInput').value = '';
            document.getElementById('binaryResult').innerHTML = '';
        }

        function downloadBinaryResult(input, inputFormat, result, outputFormat) {
            const content = `Binary Converter Result
Input: ${input} (${inputFormat})
Output: ${result} (${outputFormat})
Generated: ${new Date().toISOString()}`;
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            downloadBlob(url, `lnd-binary-conversion-${Date.now()}.txt`);
            URL.revokeObjectURL(url);
        }

        // Password Generator Functions
        function updateLengthDisplay() {
            const length = document.getElementById('passwordLength').value;
            document.getElementById('lengthDisplay').textContent = length;
        }

        function generatePasswords() {
            const length = parseInt(document.getElementById('passwordLength').value);
            const count = parseInt(document.getElementById('passwordCount').value);
            const resultDiv = document.getElementById('passwordResult');
            
            // Get character options
            const includeUppercase = document.getElementById('includeUppercase').checked;
            const includeLowercase = document.getElementById('includeLowercase').checked;
            const includeNumbers = document.getElementById('includeNumbers').checked;
            const includeSymbols = document.getElementById('includeSymbols').checked;
            const includeExtendedSymbols = document.getElementById('includeExtendedSymbols').checked;
            const excludeSimilar = document.getElementById('excludeSimilar').checked;
            const customChars = document.getElementById('customChars').value;
            
            // Validate at least one character type is selected
            if (!includeUppercase && !includeLowercase && !includeNumbers && !includeSymbols && !includeExtendedSymbols && !customChars) {
                resultDiv.innerHTML = '<div class="error-message"><span>‚ùå</span><span>Please select at least one character type.</span></div>';
                return;
            }
            
            try {
                let charset = '';
                
                // Build character set
                if (includeUppercase) charset += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
                if (includeLowercase) charset += 'abcdefghijklmnopqrstuvwxyz';
                if (includeNumbers) charset += '0123456789';
                if (includeSymbols) charset += '!@#$%^&*()_+-=[]{}|;:,.<>?';
                if (includeExtendedSymbols) charset += '~`"\'\\\/';
                if (customChars) charset += customChars;
                
                // Remove similar characters if requested
                if (excludeSimilar) {
                    charset = charset.replace(/[0Ol1]/g, '');
                }
                
                if (charset.length === 0) {
                    throw new Error('No valid characters available for password generation');
                }
                
                // Generate passwords
                const passwords = [];
                for (let i = 0; i < count; i++) {
                    passwords.push(generateSecurePassword(length, charset));
                }
                
                // Calculate strength
                const strength = calculatePasswordStrength(passwords[0], charset.length);
                
                resultDiv.innerHTML = `
                    <div class="results-section" style="background: rgba(0, 0, 0, 0.3); border-radius: 15px; padding: 25px; margin-top: 20px;">
                        <h4 style="color: var(--text-light); margin-bottom: 15px;">üîë Generated Passwords</h4>
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <strong style="color: var(--accent-purple);">Strength:</strong> 
                                <span style="color: ${strength.color}; font-weight: 600;">${strength.level}</span>
                                <span style="color: var(--text-muted); margin-left: 10px;">(${strength.entropy} bits)</span>
                            </div>
                            <div>
                                <strong style="color: var(--accent-purple);">Passwords:</strong>
                                <div style="margin-top: 10px;">
                                    ${passwords.map((password, index) => `
                                        <div style="background: rgba(0, 0, 0, 0.5); padding: 15px; border-radius: 8px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
                                            <span style="font-family: 'Courier New', monospace; color: var(--text-light); word-break: break-all; flex: 1;">${password}</span>
                                            <button class="download-btn" onclick="copyToClipboard('${password}')" style="margin-left: 15px; padding: 8px 12px; font-size: 0.8rem;">
                                                üìã Copy
                                            </button>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 20px;">
                            <button class="download-btn" onclick="downloadPasswords(${JSON.stringify(passwords).replace(/"/g, '&quot;')})">
                                ‚¨áÔ∏è Download All
                            </button>
                            <button class="download-btn" onclick="generatePasswords()" style="margin-left: 10px; background: linear-gradient(135deg, #059669, #047857);">
                                üîÑ Generate New
                            </button>
                        </div>
                    </div>
                `;
                
            } catch (error) {
                console.error('Password generation failed:', error);
                resultDiv.innerHTML = `<div class="error-message"><span>‚ùå</span><span>Password generation failed: ${error.message}</span></div>`;
            }
        }

        function generateSecurePassword(length, charset) {
            let password = '';
            const array = new Uint8Array(length);
            crypto.getRandomValues(array);
            
            for (let i = 0; i < length; i++) {
                password += charset[array[i] % charset.length];
            }
            
            return password;
        }

        function calculatePasswordStrength(password, charsetSize) {
            const entropy = Math.log2(Math.pow(charsetSize, password.length));
            
            let level, color;
            if (entropy < 30) {
                level = 'Very Weak';
                color = '#DC2626';
            } else if (entropy < 50) {
                level = 'Weak';
                color = '#F59E0B';
            } else if (entropy < 70) {
                level = 'Fair';
                color = '#EAB308';
            } else if (entropy < 90) {
                level = 'Good';
                color = '#10B981';
            } else {
                level = 'Very Strong';
                color = '#059669';
            }
            
            return {
                level,
                color,
                entropy: Math.round(entropy)
            };
        }

        function generatePassphrase() {
            const resultDiv = document.getElementById('passwordResult');
            
            // Common words for passphrase generation
            const words = [
                'apple', 'banana', 'cherry', 'dragon', 'elephant', 'forest', 'guitar', 'horizon',
                'island', 'jungle', 'kitchen', 'lemon', 'mountain', 'ocean', 'piano', 'quartz',
                'rainbow', 'sunset', 'thunder', 'umbrella', 'violet', 'whisper', 'xylophone', 'yellow',
                'zebra', 'adventure', 'butterfly', 'cascade', 'diamond', 'emerald', 'firefly', 'galaxy',
                'harmony', 'infinity', 'journey', 'kaleidoscope', 'lighthouse', 'melody', 'nebula', 'oasis'
            ];
            
            // Generate 4-6 random words
            const wordCount = 4 + Math.floor(Math.random() * 3);
            const selectedWords = [];
            
            for (let i = 0; i < wordCount; i++) {
                const randomIndex = Math.floor(Math.random() * words.length);
                selectedWords.push(words[randomIndex]);
            }
            
            // Create different formats
            const formats = [
                selectedWords.join('-'),
                selectedWords.join(' '),
                selectedWords.map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(''),
                selectedWords.join('') + Math.floor(Math.random() * 1000),
                selectedWords.join('.') + '!'
            ];
            
            resultDiv.innerHTML = `
                <div class="results-section" style="background: rgba(0, 0, 0, 0.3); border-radius: 15px; padding: 25px; margin-top: 20px;">
                    <h4 style="color: var(--text-light); margin-bottom: 15px;">üìù Generated Passphrases</h4>
                    <div style="display: grid; gap: 15px;">
                        <div>
                            <strong style="color: var(--accent-purple);">Passphrases:</strong>
                            <div style="margin-top: 10px;">
                                ${formats.map((passphrase, index) => `
                                    <div style="background: rgba(0, 0, 0, 0.5); padding: 15px; border-radius: 8px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
                                        <span style="font-family: 'Courier New', monospace; color: var(--text-light); word-break: break-all; flex: 1;">${passphrase}</span>
                                        <button class="download-btn" onclick="copyToClipboard('${passphrase}')" style="margin-left: 15px; padding: 8px 12px; font-size: 0.8rem;">
                                            üìã Copy
                                        </button>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="download-btn" onclick="downloadPasswords(${JSON.stringify(formats).replace(/"/g, '&quot;')})">
                            ‚¨áÔ∏è Download All
                        </button>
                        <button class="download-btn" onclick="generatePassphrase()" style="margin-left: 10px; background: linear-gradient(135deg, #059669, #047857);">
                            üîÑ Generate New
                        </button>
                    </div>
                </div>
            `;
        }

        // Web-Scrap functionality
        let currentScrapeTaskId = null;
        let scrapePollingInterval = null;
        let allScrapedImages = [];
        const BACKEND_URL = 'https://lnd-duckduckgo-scraper.onrender.com/';

        // Setup web-scrap event listeners
        function setupWebScrapListeners() {
            const scrapeForm = document.getElementById('scrapeForm');
            const downloadZipBtn = document.getElementById('downloadZipBtn');
            
            if (scrapeForm) {
                scrapeForm.addEventListener('submit', handleScrapeFormSubmit);
            }
            
            if (downloadZipBtn) {
                downloadZipBtn.addEventListener('click', downloadScrapedImages);
            }
        }

        // Handle scrape form submission
        async function handleScrapeFormSubmit(event) {
            event.preventDefault();
            
            if (isGenerating) {
                return;
            }
            
            const keyword = document.getElementById('scrapeKeyword').value.trim();
            if (!keyword) {
                showScrapError('Please enter a keyword to search for images.');
                return;
            }

            const numImages = parseInt(document.getElementById('scrapeCount').value);
            const quality = document.getElementById('scrapeQuality').value;

            await startImageScraping(keyword, numImages, quality);
        }

        // Start image scraping process
        async function startImageScraping(keyword, numImages, quality) {
            setGenerating(true, 'scrap');
            showScrapLoading();

            try {
                const requestData = {
                    keyword: keyword,
                    num_images: numImages,
                    quality: quality,
                    safe_search_off: true
                };

                const response = await fetch(`${BACKEND_URL}/api/scrape`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestData)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error);
                }

                currentScrapeTaskId = data.task_id;
                
                // Start polling for status
                scrapePollingInterval = setInterval(checkScrapeStatus, 2000);
                
            } catch (error) {
                console.error('Scraping error:', error);
                showScrapError(`Failed to start web scraping: ${error.message}`);
                setGenerating(false, 'scrap');
            }
        }

        // Check scraping status
        async function checkScrapeStatus() {
            if (!currentScrapeTaskId) {
                return;
            }

            try {
                const response = await fetch(`${BACKEND_URL}/api/status/${currentScrapeTaskId}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                
                updateScrapeProgress(data);
                
                if (data.status === 'completed') {
                    clearInterval(scrapePollingInterval);
                    scrapePollingInterval = null;
                    allScrapedImages = data.images || [];
                    displayScrapedImages(data);
                    setGenerating(false, 'scrap');
                } else if (data.status === 'error') {
                    clearInterval(scrapePollingInterval);
                    scrapePollingInterval = null;
                    showScrapError(data.message || 'Web scraping failed');
                    setGenerating(false, 'scrap');
                }
                
            } catch (error) {
                console.error('Status check error:', error);
                clearInterval(scrapePollingInterval);
                scrapePollingInterval = null;
                showScrapError('Failed to check scraping status');
                setGenerating(false, 'scrap');
            }
        }

        // Update scraping progress
        function updateScrapeProgress(data) {
            const container = document.getElementById('scrapResultsContainer');
            const progress = data.progress || 0;
            const message = data.message || 'Processing...';
            
            container.innerHTML = `
                <div class="loading-container">
                    <div class="loading-spinner"></div>
                    <div class="loading-text">${message}</div>
                    <div class="loading-subtext">Progress: ${progress}% ‚Ä¢ Web Search in Progress</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${progress}%"></div>
                    </div>
                </div>
            `;
        }

        // Display scraped images (MAX 6 for optimal viewing)
        function displayScrapedImages(data) {
            const container = document.getElementById('scrapResultsContainer');
            const countElement = document.getElementById('scrapResultsCount');
            const downloadBtn = document.getElementById('downloadZipBtn');
            
            const images = data.images || [];
            const totalImages = data.total_images || images.length;
            
            countElement.textContent = `${totalImages} Images (Showing 6)`;
            
            if (images.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">‚ùå</div>
                        <div class="empty-text">No Images Found</div>
                        <div class="empty-subtext">Try a different keyword or check your connection</div>
                    </div>
                `;
                return;
            }
            
            // Show download button
            downloadBtn.style.display = 'inline-block';
            
            // Display only first 6 images for optimal viewing
            const displayImages = images.slice(0, 6);
            
            container.innerHTML = `
                <div class="image-grid">
                    ${displayImages.map((img, index) => `
                        <div class="image-card" style="animation: fadeIn 0.5s ease ${index * 0.1}s both">
                            <div class="image-container">
                                <img src="${BACKEND_URL}/api/image/${currentScrapeTaskId}/${index}" 
                                     alt="Web scraped image ${index + 1}" 
                                     loading="lazy"
                                     style="width: 100%; height: 300px; object-fit: cover;"
                                     onerror="this.src=\'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMzMzIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkltYWdlIEVycm9yPC90ZXh0Pjwvc3ZnPg==\';"
                                />
                                <div class="image-overlay">
                                    <button class="download-btn" onclick="downloadSingleImage(${index})">
                                        ‚¨áÔ∏è Download
                                    </button>
                                </div>
                            </div>
                            <div class="image-info">
                                <div class="image-source">Source: Web Search</div>
                                <div class="image-filename">${img.filename || `web_image_${index + 1}.jpg`}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
                ${totalImages > 6 ? `
                    <div style="text-align: center; margin-top: 20px; padding: 20px; background: rgba(139, 92, 246, 0.1); border-radius: 15px;">
                        <p style="color: var(--text-accent); margin-bottom: 10px;">
                            Showing 6 of ${totalImages} images for optimal viewing. Download the ZIP file to get all images.
                        </p>
                        <div style="color: var(--accent-purple); font-weight: 700;">
                            üîç WEB SCRAPING: ${totalImages} images scraped successfully!
                        </div>
                    </div>
                ` : ''}
            `;
        }

        // Download single scraped image
        async function downloadSingleImage(imageIndex) {
            if (!currentScrapeTaskId) {
                return;
            }
            
            try {
                const imageUrl = `${BACKEND_URL}/api/image/${currentScrapeTaskId}/${imageIndex}`;
                
                const response = await fetch(imageUrl);
                
                if (!response.ok) {
                    throw new Error(`Failed to download image: HTTP ${response.status}`);
                }
                
                const blob = await response.blob();
                const url = URL.createObjectURL(blob);
                const filename = allScrapedImages[imageIndex]?.filename || `web_image_${imageIndex + 1}.jpg`;
                
                downloadBlob(url, filename);
                URL.revokeObjectURL(url);
                
            } catch (error) {
                console.error('Download error:', error);
                showScrapError('Failed to download image');
            }
        }

        // Download all scraped images as ZIP
        async function downloadScrapedImages() {
            if (!currentScrapeTaskId) {
                return;
            }
            
            // Show download message
            showDownloadMessage();
            
            try {
                const downloadUrl = `${BACKEND_URL}/api/download/${currentScrapeTaskId}`;
                
                const response = await fetch(downloadUrl);
                
                if (!response.ok) {
                    throw new Error(`Failed to download ZIP file: HTTP ${response.status}`);
                }
                
                const blob = await response.blob();
                const url = URL.createObjectURL(blob);
                const keyword = document.getElementById('scrapeKeyword').value.trim();
                const filename = `web_scraped_${keyword}_images_${allScrapedImages.length}_files.zip`;
                
                downloadBlob(url, filename);
                URL.revokeObjectURL(url);
                
            } catch (error) {
                console.error('ZIP download error:', error);
                showScrapError(`Failed to download ZIP file: ${error.message}`);
            }
        }

        // Show download message
        function showDownloadMessage() {
            const container = document.getElementById('scrapResultsContainer');
            const existingMessage = container.querySelector('.download-message');
            
            if (!existingMessage) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'download-message';
                messageDiv.innerHTML = `
                    <div style="background: rgba(139, 92, 246, 0.1); border: 2px solid var(--accent-purple); border-radius: 15px; padding: 20px; margin-bottom: 20px; text-align: center;">
                        <div style="color: var(--accent-purple); font-weight: 700; font-size: 1.1rem; margin-bottom: 5px;">üì¶ Your ZIP will be downloaded shortly!</div>
                        <div style="color: var(--text-accent); font-size: 0.9rem;">Please wait patiently while we prepare your images...</div>
                    </div>
                `;
                container.insertBefore(messageDiv, container.firstChild);
                
                // Remove message after 5 seconds
                setTimeout(() => {
                    if (messageDiv.parentNode) {
                        messageDiv.remove();
                    }
                }, 5000);
            }
        }

        // Show scraping loading state
        function showScrapLoading() {
            const container = document.getElementById('scrapResultsContainer');
            container.innerHTML = `
                <div class="loading-container">
                    <div class="loading-spinner"></div>
                    <div class="loading-text">Starting Web Scraping</div>
                    <div class="loading-subtext">Searching for images across the web...</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%"></div>
                    </div>
                </div>
            `;
        }

        // Show scraping error
        function showScrapError(message) {
            const container = document.getElementById('scrapResultsContainer');
            container.innerHTML = `
                <div class="error-message">
                    <span style="font-size: 1.5rem;">‚ö†Ô∏è</span>
                    <div>
                        <div style="font-weight: 700; margin-bottom: 5px;">Web Scraping Error</div>
                        <div>${message}</div>
                    </div>
                </div>
            `;
        }

        function downloadPasswords(passwords) {
            const content = `LND Password Generator Results
Generated: ${new Date().toISOString()}

Passwords:
${passwords.map((password, index) => `${index + 1}. ${password}`).join('\n')}

‚ö†Ô∏è Security Notice:
- Store these passwords securely
- Do not share via unsecured channels
- Consider using a password manager
- Change passwords regularly`;
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            downloadBlob(url, `lnd-passwords-${Date.now()}.txt`);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>

